ubData Sections
The format described thus far works well for most kinds of data in Simulator. It does not work as well however for data 
that stores a list of objects. For example, a contingency stores some information about itself (such as its name), and then a 
list of contingency elements, and possible a list of limit violations as well. For data such as this, Simulator allows 
<SubData>, </SubData> tags that store lists of information about a particular object. This formatting looks like the 
following
object_type (list_of_fields)
{
value_list_1
 <SUBDATA subobject_type1>
 precise format describing an object_type1
 precise format describing an object_type1
 .
 .
 .
 </SUBDATA>
 <SUBDATA subobject_type2>
 precise format describing an object_type2
 precise format describing an object_type2
 .
 .
 .
 </SUBDATA>
value_list_2
 .
 .
 .
value_list_n
}
Note that the information contained inside the <SubData>, </SubData> tags may not be flexibly defined. It must be 
written in a precisely defined order that will be documented for each SubData type. The description of each of these 
SubData formats follows.
163
ATC_Options
RLScenarioName
GScenarioName
IScenarioName
These three sections contain the pretty names of the RL Scenarios, G Scenarios, and I Scenarios. Each line 
consists of two values: Scenario Number and a name string enclosed in quotes.
Scenario Number : The scenarios are number 0 through the number of scenarios minus 1.
Scenario Name : These represent the names of the various scenarios.
Example:
<SUBDATA RLScenarioName>
//Index Name
 0 "Scenario Name 0"
 1 "Scenario Name 1"
</SUBDATA>
ATCMemo
This section contains the memo text for the ATC analysis.
Example:
<SUBDATA ATCMemo>
//Memo
"Comments for the ATC analysis"
</SUBDATA>
ATCExtraMonitor
ATCFlowValue
This subdata section contains a list of a flow values for specified transfer levels. Each line consists of two 
values: Flow Value (flow on the monitored element) and a Transfer Level (in MW). 
Flow Value : Contains a string describing which monitor this belongs to.
Transfer Level : Contains the value for this extra monitor at the last linear iteration.
Example:
<SUBDATA ATCFlowValue>
//MWFlow TransferLevel
 94.05 55.30
 105.18 80.58
 109.02 107.76
</SUBDATA>
164
ATCScenario
TransferLimiter
This subdata section contains a list of the TransferLimiters for this scenario. Each line contains fields 
relating one of the Transferlimiters. The fields are written out in the following order:
Limiting Element : Contains a description of the limiting element. The possible values are:
"PowerFlow Divergence"
"AREA num"
"SUPERAREA name"
"ZONE num"
"BRANCH num1 num2 ckt"
"INJECTIONGROUP name"
"INTERFACE name"
Limiting Contingency : The name of the limiting contingency. If blank, then this means it’s a 
limitation in the base case.
MaxFlow : The transfer limitation in MW in per unit.
PTDF : The PTDF on the limiting element in the base case (not in percent).
OTDF : The OTDF on the limiting element under the limiting contingency.
LimitUsed : The limit which was used to determine the MaxFlow in per unit.
PreTransEst : The estimated flow on the line after the contingency but before the 
transfer in per unit.
MaxFlowAtLastIteration
: The total transfer at the last iteration in per unit.
IterativelyFound : Either YES or NO depending on whether it was iteratively determined.
Example:
<SUBDATA TransferLimiter >
 "BRANCH 40767 42103 1" "contin" 2.84 -0.0771 -0.3883 -4.35 -4.35 -0.01 "-55.88" 
YES
 "BRANCH 42100 42321 1" "Contin" 4.42 0.1078 0.5466 6.50 5.64 1.57 " 22.59" NO 
 "BRANCH 42168 42174 1" "Contin" 7.45 -0.0131 -0.0651 -1.39 -1.09 4.60 "-33.31" NO 
 "BRANCH 42168 42170 1" "Contin" 8.54 0.0131 0.0651 1.39 1.02 5.69 " 26.10" NO 
 "BRANCH 41004 49963 1" "Contin" 9.17 -0.0500 -0.1940 -4.39 -3.16 6.32 " 68.73" NO 
 "BRANCH 46403 49963 1" "Contin" 9.53 0.0500 0.1940 4.46 3.16 6.68 "-68.68" NO 
 "BRANCH 42163 42170 1" "Contin" 10.14 -0.0131 -0.0651 -1.39 -0.92 7.29 "-15.58" NO 
</SUBDATA>
ATCExtraMonitor
This subdata section contains a list of the ATCExtraMonitors for this scenario. Each line contains three 
fields relating one of the ATCExtraMonitors. The first field describes the ATCExtraMonitor which this 
subdata corresponds to. The second and third variables are the initial value and sensitivity for this extra 
monitor for the sceanario. An optional fourth field may be included if we are using one of the iterated 
ATC solution options. This field must be the String "ATCFlowValue".
Monitor Description : Contains a string describing which monitor this belongs to.
InitialValue : Contains the value for this extra monitor at the last linear iteration.
Sensitivity : Contains the senstivity of this monitor.
ATCFlowValue : A string which signifies that a block will follow which stores a list of flow 
values for specified transfer levels. Each line of the block consists of two 
values: Flow Value (flow on the monitored element) and a Transfer Level 
(in MW). The block is terminated when a line of text that starts with 
‘END’ is encountered.
165
Example:
<SUBDATA ATCExtraMonitor>
 "Interface<KEY1>Left-Right</KEY1>" 40.0735 0.633295
 "Branch<KEY1>2</KEY1><KEY2>5</KEY2><KEY3>1</KEY3>" 78.7410 0.266589
</SUBDATA>
AUXFileExportFormatData
DataBlockDescription
This subdata section is used to define the objects that should be included in an auxiliary file along with 
their fields, subdata sections, and any filter used to specify which objects should be included. Each line 
contains the following:
ObjectType : Name of the object to include in the auxiliary file.
[FieldList] : List of fields to include. Must be enclosed in brackets. This list can either 
be space-delimited or comma-delimited.
[SubdataList] : List of subdata sections to include. This list must be enclosed in brackets 
and can be either space-delimited or comma-delimited. Include empty 
brackets to not include subdata or for objects that do not have any 
subdata sections. 
"Filter" : Description of the filter to use for determining which objects to include. 
This must be enclosed in double quotes. If no filter is to be used, empty 
double quotes should be included. Valid entries are: "", "filtername", 
"AREAZONE", and "SELECTED". See the Using Filters in Script Commands
section for more information on specifying the filtername.
Example:
<SUBDATA DataBlockDescription>
 // ObjectType [FieldList] [SubdataList] "Filter"
 Area [AreaName, AreaNum] [] "SELECTED"
 Gen [BusNum, BusName, GenID] [BidCurve, ReactiveCapability] ""
</SUBDATA>
AUXFileExportFormatDisplay
DataBlockDescription
Same format as for the AUXFileExportFormatData subdata section.
Example:
<SUBDATA DataBlockDescription>
 // ObjectType [FieldList] [SubdataList] "Filter"
 DisplayArea [AreaName, AreaNum, SOAuxiliaryID] [] ""
 DisplayTransmissionLine [BusNum, BusNum:1, LineCircuit, SOAuxiliaryID] 
 [Line] "Nominal Voltage > 138 kV"
</SUBDATA>
BGCalculatedField
Condition
Calculated Fields allow you to define a calculation over most network and aggregation objects along with 
a few other types of objects. The calculation can then be used to show an aggregation calculation on 
objects that link to these calculation objects in some manner. Part of the definition is a filter which 
specifies which objects to operate over. This subdata section is identical to the Condition subdata section 
of the Filter object type.
166
Bus
MWMarginalCostValues
MvarMarginalCostValues
LPOPFMarginalControls
These three sections contain specific values computed for an OPF solution. In MWMarginalCostValues or 
MvarMarginalCostValues these specific values are the MW or Mvar marginal prices for each constraint. In 
LPOPFMarginalControls the values are the sensitivities of the controls with respect to the cost of each bus.
Example:
<SUBDATA MWMarginalCostValues>
 //Value
 16.53
 0.00
 21.80
</SUBDATA>
BusViewFormOptions
BusViewBusField
BusViewFarBusField
BusViewGenField
BusViewLineField
BusViewLoadField
BusViewShuntField
The values represent specific fields on the custom defined bus view onelines. Each line contains two 
values:
Location : The various locations on the customized bus view contain slots for fields. 
This is the slot number.
FieldDescription : This is a string enclosed in double quotes. The string itself is delimited 
by the @ character. The string contains five values:
Name of Field : The name of the field. Special fields that appear 
on dialog by default have special names. 
Otherwise these are the same as the fieldnames of 
the AUX file format (for the "other fields" feature 
on the dialogs).
Total Digit : Number of total digits for a numeric field.
Decimal Points : Number of decimal points for a numeric field.
Color : This is the color of the field. It is not presently 
used.
Increment Value : This is the "delta per mouse" click for the field.
Example:
<SUBDATA BusViewLineField>
 0 "MW Flow@6@1@0@0"
 1 "MVar Flow@6@1@0@0"
 2 "MVA Flow@6@1@0@0"
 3 "BusAngle:1@6@2@0@0"
</SUBDATA>
167
ColorMap
ColorPoint
A colorpoint is simply described by a real number (between 0 and 100) indicating the percentage 
breakpoint, an integer describing the color, and a field indicating if the color should be used or the 
contour should be transparent. These three values are written on a single line of text. Each line contains 
two values:
cmvalue : Real number between 0 and 100 (minimum to maximum value).
cmcolor : Integer between 0 and 16,777,216. Value is determined by taking the 
red, green and blue components of the color and assigning them a value 
between 0 and 255. The color is then equal to red + 256*green + 
256*256*blue.
cmalpha : Integer between 0 and 255, where only 0 and 255 are valid values. A 
value of 0 indicates that the color point is transparent, while a value of 
255 indicates that the color point is opaque. If the alpha channel is 
omitted, a default value of 255 (opaque) will be assigned.
Example:
<SUBDATA ColorPoint>
 // Value Color Alpha
 100.0000 127 255
 62.5000 65535 255
 50.0000 8388479 0
 12.5000 16711680 0
 0.0000 8323072 255
</SUBDATA>
Contingency
CTGElementAppend
Normally when reading in contingency definitions, the CTGElement SubData section is used to define the 
list of elements. When reading a CTGElement SubData section, all existing elements of the contingency 
are deleted are replaced with the ones read from the file. Using the CTGElementAppend as the SubData 
section will modify this behavior so that the elements are appended to the existing ones instead of 
deleted.
CTGElement
A contingency element is described by up to the following entries. All entries must be on a single line of 
text:
Action : String describing the action associated with this element. See below for 
actions available.
ModelCriteria : This is the name of a ModelFilter or ModelCondition under which this 
action should be performed. This entry is optional. If it is not specified, 
then a blank (or no criteria) is assumed. If you want to enter a Status, 
then use must specify "" as the ModelCriteria.
168
Status : The following options are available:
CHECK : perform action if ModelCriteria is true
ALWAYS : perform action regardless of ModelCriteria
NEVER : do not perform action
TOPOLOGYCHECK: perform action if ModelCriteria is true following
implementation of other actions and before 
solving the power flow
POSTCHECK : perform action if ModelCriteria is true following
implementation of other actions and solving the 
power flow
SOLUTIONFAIL : perform the action if ModelCriteria is true or not 
defined following the failure of the power flow 
solution.
This entry is optional. If it is not specified, then CHECK is assumed.
InclusionFilter : This entry is optional and will only exist for elements of RemedialAction 
or GlobalContingencyActions objects. This is the name of an advanced 
filter or device filter that gets applied to each contingency. If the 
contingency meets the filter, that contingency will include this element. 
Otherwise, the element will be ignored.
TimeDelay : This entry is optional. If not specified, 0 is assumed. This entry will only 
exist for elements of Contingency, RemedialAction, or 
GlobalContingencyActions objects. This is the time delay in seconds to 
wait before the action takes place. 
Persistent : This entry is optional. It not specified, NO is assumed. Normally after a 
contingency action has been implemented it will not be applied again. 
Setting this option to YES to mark an action as persistent will change this 
behavior. Any action marked as persistent that also has a Status of 
TOPOLOGYCHECK, POSTCHECK, or SOLUTIONFAIL will be applied in the 
appropriate section of the overall contingency process any time that its 
ModelCriteria is met. An exception is that a SOLUTIONFAIL element will 
only remain persistent until a solution is successfully achieved.
ArmingCriteria : This entry is optional and will only exist for elements of RemedialAction 
objects. This is the name of a ModelFilter or ModelCondition under 
which this action should be armed. If it is not specified, then a blank (or 
no criteria) is assumed. If you want to enter a ArmingStatus, then use 
must specify "" as the ArmingCriteria.
ArmingStatus : This entry is optional and will only exist for elements of RemedialAction 
objects. If not specified, CHECK is assumed. The following options are 
available: 
CHECK : action is armed if ArmingCriteria is true
ALWAYS : action is considered armed regardless of ArmingCriteria
NEVER : action is not armed
Comment : All text to the right of the comment symbol (//) will be saved with the 
CTGElement as a comment.
Possible Actions:
Many actions have a value field that can be specified. This value can be expressed in three ways:
1. A numerical value that will be used directly.
2. The variablename of a field for the object in the action preceded by the tag <Field>. This field 
will be evaluated and that value will be used. Including the keyword REF in the appropriate place 
in the action string will cause the field to be evaluated in the contingency reference case. 
Otherwise, the field will be evaluated at the moment the action is implemented.
169
3. The name of a Model Expression preceded by the tag <Expression>. Single quotes should 
enclose the entirety of the tag and the name if the name contains spaces. The model expression 
will be evaluated and the result will be used as the value. Including the keyword REF in the 
appropriate place in the action string will cause the model expression to be evaluated in the 
contingency reference case. Otherwise, the model expression will be evaluated at the moment 
the action is implemented.
Transmission Line or Transformer outage or insertion
BRANCH | bus1# bus2# ckt | OPEN
| | CLOSE
| | OPENCBS
| | CLOSECBS
| | SET_TO | value | LimitMVA | REF
Takes branch out of service, or puts it in service. The contingency rating of the branch can also be set for 
the duration of the contingency using the SET_TO action. Note: bus# values may be replaced by a string 
enclosed in single quotes where the string is the name of the bus followed by an underscore character 
and then the nominal voltage of the bus. These values may also be replaced by a string enclosed in single 
quotes which represents the label of the bus. Also, the entire sequence [bus1# bus2# ckt] may be 
replaced by the label of the branch.
Generator, Load, or Switched Shunt outage or insertion
GEN | bus# id | OPEN, CLOSE, OPENCBS, or CLOSECBS
LOAD | bus# id | OPEN, CLOSE, OPENCBS, or CLOSECBS
SHUNT | bus# id | OPEN, CLOSE, OPENCBS, or CLOSECBS
INJECTIONGROUP | name | OPEN, CLOSE, OPENCBS, or CLOSECBS
Takes a generator, load, or shunt out of service, or puts it in service. If specifying an injection group, the 
status of all devices in the injection group will be changed. Note: bus# values may be replaced by a string 
enclosed in single quotes where the string is the name of the bus followed by an underscore character 
and then the nominal voltage of the bus. These values may also be replaced by a string enclosed in single 
quotes which represents the label of the bus. Also, the sequence [bus1# ckt] or [name] may be replaced 
by the label of the device.
Generator, Load or Switched Shunt movement to another bus
For the following set of actions, all of the object types can use the same action keywords which are 
associated with the value keyword following the actual value. The move is based on specifying a bus:
GEN | bus1# | MOVE_P_TO | bus2# | value | MW | REF
LOAD | | MOVE_Q_TO | | | MVR |
SHUNT | | | | | |
For the following set of actions, all of the object types can use the same action keywords which are 
associated with the value keyword following the actual value. The move is based on specifying a 
particular device:
GEN | bus1# id | MOVE_P_TO | bus2# | value | MW | REF
LOAD | | MOVE_Q_TO | | | MVR |
SHUNT | | | | | |
Generator actions that move a generator by a percentage only apply to the generator MW:
GEN | bus1# | MOVE_P_TO | bus2# | value | PERCENT | REF
GEN | bus1# id | MOVE_P_TO | bus2# | value | PERCENT | REF
170
The following set of actions are used for specifying a load move by maintaining a constant power factor: 
LOAD | bus1# | MOVE_PQ_TO | bus2# | value | MW | REF
LOAD | bus1# id | MOVE_PQ_TO | bus2# | | MW |
The following set of actions apply to loads and shunts and are used to move a percentage of the entire 
MW and Mvar output. The move is based on specifying a bus:
LOAD | bus1# | MOVE_PQ_TO | bus2# | value | PERCENT | REF
SHUNT | | | | | |
The following set of actions apply to loads and shunts and are used to move a percentage of the entire 
MW and Mvar output. The move is based on specifying a particular device:
LOAD | bus1# id | MOVE_PQ_TO | bus2# | value | PERCENT | REF
SHUNT | | | | | |
Use to move generation, load or shunt at a bus1 over to bus2. This can be used on a bus or specific
device basis in specifying what to move. Note: bus# values may be replaced by a string enclosed in single 
quotes where the string is the name of the bus followed by an underscore character and then the nominal 
voltage of the bus. These values may also be replaced by a string enclosed in single quotes which 
represents the label of the bus. When identifying specific devices, the device label can replace the bus 
number and device id. 
Generator, Load or Switched Shunt set or change a specific value
For the following set of actions, all of the object types can use the same action keywords which are 
associated with the value keyword following the actual value. These changes are based on specifying a 
bus:
GEN | bus# | SET_P_TO | value | MW | REF
LOAD | | SET_Q_TO | | MVR |
SHUNT | | CHANGE_P_BY | | MW |
| | CHANGE_Q_BY | | MVR |
For the following set of actions, all of the object types can use the same action keywords which are 
associated with the value keyword following the actual value. These changes are based on specifying a 
bus:
GEN | bus# id | SET_P_TO | value | MW | REF
LOAD | | SET_Q_TO | | MVR |
SHUNT | | CHANGE_P_BY | | MW |
| | CHANGE_Q_BY | | MVR |
The following set of actions are used to set or change the MW output of generation at a bus by a 
percentage:
GEN | bus# | SET_P_TO | value | PERCENT | REF
GEN | | CHANGE_P_BY | | |
The following set of actions are used to set or change the MW output of a particular generator by a 
percentage:
GEN | bus# id | SET_P_TO | value | PERCENT | REF
GEN | | CHANGE_P_BY | | |
The following set of actions apply to loads and shunts and are used to set or change a percentage of the 
entire MW and Mvar output. This based on specifying a bus:
LOAD | bus# | SET_PQ_TO | value | PERCENT | REF
SHUNT | | CHANGE_PQ_BY | | |
The following set of actions apply to loads and shunts and are used to set or change a percentage of the 
entire MW and Mvar output. This based on specifying a specific device:
LOAD | bus# id | SET_PQ_TO | value | PERCENT | REF
SHUNT | | CHANGE_PQ_BY | | |
The following set of actions are used to specify a load set or change by maintaining a constant power 
factor. This is based on specifying a bus:
LOAD | bus# | SET_PQ_TO | value | MW | REF
| | CHANGE_PQ_BY | | MW |
The following set of actions are used to specify a load set or change by maintaining a constant power 
factor. This is based on specifying a specific load:
171
LOAD | bus# id | SET_PQ_TO | value | MW | REF
| | CHANGE_PQ_BY | | MW |
The following set of actions apply to generators and shunts and are used to set or change the setpoint 
voltage of the devices at the specified bus:
GEN | bus# | SET_VOLT_TO | value | PU | REF
SHUNT | |CHANGE_VOLT_BY | | |
The following set of actions apply to generators and shunts and are used to set or change the setpoint 
voltage of the specified device:
GEN | bus# id | SET_VOLT_TO | value | PU | REF
SHUNT | |CHANGE_VOLT_BY | | |
Note: bus# values may be replaced by a string enclosed in single quotes where the string is the name of 
the bus followed by an underscore character and then the nominal voltage of the bus. These values may 
also be replaced by a string enclosed in single quotes which represents the label of the bus. When 
identifying specific devices, the device label can replace the bus number and device id.
Bus outage causes all lines connected to the bus to be outage
BUS | bus# | OPEN
| OPENCBS
Takes all branches connected to the bus out of service. Also outages all generation, load, or shunts 
attached to the bus. Note: bus# values may be replaced by a string enclosed in single quotes where the 
string is the name of the bus followed by an underscore character and then the nominal voltage of the 
bus. These values may also be replaced by a string enclosed in single quotes which represents the label of 
the bus.
Interface outage or insertion
INTERFACE | name | OPEN
| CLOSE
| OPENCBS
| CLOSECBS
Takes all monitored branches in the interface out of service, or puts them all in service. Open actions will 
also open all generators and loads contained in the interface including generators and loads inside any 
injection groups or other interfaces. Note: the [name] may be replaced by the label of the interface.
Interface change specific value
INTERFACE | name | CHANGE_P_BY | value | Option | REF | PPREF
| SET_P_TO | | | |
The following Option settings are allowed to set or change the MW flow of an interface by or to a 
particular value:
MWMERITORDEROPEN
: Value will be interpreted as the amount of MW flow change or new MW 
flow. The element in the interface with the highest participation factor 
will be opened, followed by the second generator and so on. This will 
continue until the amount of MW flow opened is as close to the desired 
amount as possible without exceeding the amount of MW flow open. If 
an element will cause a change in flow that is not in the desired direction, 
that element is not opened and the next element is examined. 
PERCENTMERITORDEROPEN or %MERITORDEROPEN
: Same as MWMERITORDEROPEN except that the value will be interpreted 
as percentage of the contingency reference state MW flow.
MWMERITORDEROPENEXCEED
: Same as MWMERITORDEROPEN except that the amount of MW opened is 
allowed to exceed the desired amount of change. Interface elements will 
be opened in merit order until the desired amount is met or exceeded.
PERCENTMERITORDEROPENEXCEED or %MERITORDEROPENEXCEED
172
: Same as MWMERITORDEROPENEXCEED except that the value will be 
interpreted as percentage of the contingency reference state MW 
injection.
MWEFFECTOPEN
: Value that is specified with the action is the desired MW Effect that the 
action should have. The participation factors defined with the interface 
elements will be interpreted as effectiveness factors akin to transfer 
distribution factors. These factors are supplied as input by the user when 
defining the interface. The effectiveness factors are multiplied by the 
present MW flow of elements in the interface to determine how much 
effect they will have if dropped. The flow of an element is determined by
its MW flow multiplied by the Weighting factor specified with the 
element. If the effect of a particular element is in the opposite direction 
of the desired effect, that element is skipped. The action will find the 
smallest number of elements to drop that results in a total MW Effect 
that is within 5% of the desired MW Effect, but does not exceed the 
desired MW Effect. 
This option is not valid with SET_P_TO actions.
MWEFFECTOPENEXCEED
: Same as MWEFFECTOPEN but it will ensure that the total MW Effect is 
within 5% of the total desired MW Effect and also meets or exceeds the 
desired MW Effect. 
This option is not valid with SET_P_TO actions.
MWBESTFITOPEN
: Value will be interpreted as the amount of MW flow change or new MW 
flow. When using this option the participation factors of interface 
elements do not impact which elements are opened. The flow on an 
element, which is determined by its MW flow multiplied by the weighting 
factor specified with the element, is used to determine which elements 
should be opened. If the follow on an element is in the appropriate 
direction to achieve the desired flow change on the interface, that 
element is eligible fo being opened. To determine if an element will 
actually be opened, the best fit algorithm attempts to determine the 
combination of elements that will achieve the desired flow change by 
opening the least amount of elements and achieving an actual flow 
change within 5% fo the desired flow change without exceeding the 
desired amount.
MWBESTFITOPENEXCEED
: Same as MWBESTFITOPEN except that the MW flow change is allowed to 
exceed the desired amount of change. 
PERCENTBESTFITOPEN or %BESTFITOPEN
: Same as MWBESTFITOPEN except that the value will be interpreted as 
percentage of the contingency reference state MW flow.
PERCENTBESTFITOPENEXCEED or %BESTFITOPENEXCEED
: Same as PERCENTBESTFITOPEN except that the MW flow change is 
allowed to exceed the desired amount of change. 
When using an action that requires participation factors, an optional parameter PPREF can be specified. 
This indicates that the participation factors should be determined in the contingency reference case. 
Interfaces can contain other interfaces. The treatment of interfaces within interfaces is to open the entire 
contained interface when using the MWMERITORDEROPEN type actions.
 
173
Notes: The [name] may be replaced by the label of the interface. 
Line Shunt outage or insertion
LINESHUNT | bus1# bus2# bus# ckt | OPEN
| CLOSE
Takes a line shunt out of service, or puts it in service. bus1# and bus2# identify the line that the line shunt 
is on and bus# identifies the side of the line that the line shunt is on. bus# values may be replaced by a 
string enclosed in single quotes where the string is the name of the bus followed by an underscore 
character and then the nominal voltage of the bus. bus# values may also be replaced by a string enclosed 
in single quotes that represents the label of the bus. The sequence [bus1# bus2#] may be replaced by the 
label of the line to which the line shunt is attached.
Injection Group outage or insertion
INJECTIONGROUP | name | OPEN
| CLOSE | value | REF | PPREF
| OPENCBS
| CLOSECBS
| OPEN | value | REF | PPREF
Takes all devices in the injection group out of service, or puts them all in service. 
The OPEN action will open all devices in the injection group if no value is specified. If a value is specified, 
only that number of devices will be opened in the order of highest to lowest participation factor. The 
CLOSE action will close all devices in the injection group if no value is specified. If a value is specified, 
only that number of devices will be closed in the order of highest to lowest participation factor. When 
using an action that requires participation factors, an optional parameter PPREF can be specified. This 
indicates that the participation factors should be determined in the contingency rerference case. This will 
only be done for participation points using an AutoCalcMethod that indicates the factor should be 
dynamically determined and the AutoCalc field is set to YES for the participation point.
The [name] may be replaced by the label of the injection group. Bus participation points will be 
completely ignored in this process.
Injection Group change specific value
INJECTIONGROUP | name | CHANGE_P_BY | value | Option | REF | PPREF
| SET_P_TO | | | |
The following Option settings are allowed to set or change the MW generation/load in an injection 
group by or to a particular value:
MW : Value will be interpreted as the amount of MW injection change or new 
MW injection. Each participation point in the injection group will be 
changed in proportion to the participation factors of the group.
PERCENT or % : Same as MW except that the value will be interpreted as percentage of 
the contingency reference state MW injection.
MWMERITORDER : Value will be interpreted as the amount of MW injection change or new 
MW injection. Both generator and load points will be modified in the 
injection group. Elements will be adjusted in order of highest 
participation factor to lowest before moving to the next element. This 
process continues until the desired injection is met. Generators will not 
be opened in this process, which means all online generators will 
continue to provide Mvar support. Loads that have both their minimum 
and maximum MW limits set to zero will not be allowed to increase. 
They can only decrease towards 0.
PERCENTMERITORDER or %MERITORDER
: Same as MWMERITORDER except that the value will be interpreted as 
percentage of the contingency reference state MW injection.
174
MWMERITORDEROPEN
: Value will be interpreted as the amount of MW injection change or new 
MW injection. Both generator and load points can be modified in the 
injection group. If the MW injection change is negative, the generator in 
the injection group with the highest participation factor will have its 
status changed to Open, followed by the second generator and so on. 
This will continue until the amount of MW opened is as close to the 
desired amount as possible without exceeding the desired amount of 
drop. If the MW injection change is positive, loads will be opened in the 
same manner. If an element would cause the desired gen drop amount 
to be exceeded, that element is skipped and the next element in merit 
order is processed. If the change requested is positive and there are no 
loads in the injection group, generators will be increased toward their 
maximum MW output in the same manner as MWMERITORDER as though 
the OPEN option was not specified. If the change requested is negative 
and there are no generators in the injection group, loads will be 
increased toward their maximum MW output in the same manner as 
MWMERITORDER as though the OPEN option was not specified.
PERCENTMERITORDEROPEN or %MERITORDEROPEN
: Same as MWMERITORDEROPEN except that the value will be interpreted 
as percentage of the contingency reference state MW injection.
MWMERITORDEROPENEXCEED
: Same as MWMERITORDEROPEN except that the amount of MW opened is 
allowed to exceed the desired amount of change. Generators or loads
will be opened in merit order until the desired amount is met or 
exceeded.
PERCENTMERITORDEROPENEXCEED or %MERITORDEROPENEXCEED
: Same as MWMERITORDEROPENEXCEED except that the value will be 
interpreted as percentage of the contingency reference state MW 
injection.
MWEFFECTOPEN : Value that is specified with the action is the desired MW Effect that the 
action should have. The participation factors defined with the Injection 
Group will be interpreted as effectiveness factors akin to transfer 
distribution factors. These factors are supplied as input by the user when 
defining the injection group. The effectiveness factors are multiplied by 
the present output of generators (or loads) in the injection group to 
determine how much effect they will have if dropped. The action will find 
the smallest number of generators (or loads) to drop which results in a 
total MW Effect that is within 5% of the desired MW Effect, but does not 
exceed the desired MW Effect. 
This option is not valid with SET_P_TO actions.
MWEFFECTOPENEXCEED
: Same as MWEFFECTOPEN but it will ensure that the total MW Effect is 
within 5% of the total desired MW Effect and also meets or exceeds the 
desired MW Effect. 
This option is not valid with SET_P_TO actions.
MWBESTFITOPEN : Value will be interpreted as the amount of MW injection change or new 
MW injection. When using this option the participation factors do not 
impact which elements are opened. All generators or loads defined with 
the injection group can participate if they are online. Specifially which 
generators or loads depends on an algorithm that attempts to get the 
actual injection change within 5% of the desired injection change by 
175
opening the smallest number of generators or loads without exceeding 
the desired amount. 
MWBESTFITOPENEXCEED
: Same as MWBESTFITOPEN except that the MW injection change is 
allowed to exceed the desired amount of change. 
PERCENTBESTFITOPEN or %BESTFITOPEN
: Same as MWBESTFITOPEN except that the value will be interpreted as 
percentage of the contingency reference state MW injection.
PERCENTBESTFITOPENEXCEED or %BESTFITOPENEXCEED
: Same as PERCENTBESTFITOPEN except that the MW injection change is 
allowed to exceed the desired amount of change.
When using an action that requires participation factors, an optional parameter PPREF can be specified. 
This indicates that the participation factors should be determined in the contingency reference case. This 
will only be done for participation points using an AutoCalcMethod that indicates the factor should be 
dynamically determined and the AutoCalc field is set to YES for the participation point. 
Injection Groups can contain participation points that reference another injection group. The treatment of 
injection groups within injection groups will be to drop the entire contained injection group when using 
the MWMERITORDEROPEN and MWEFFECTOPEN type actions.
 
Notes: The [name] may be replaced by the label of the injection group. Bus participation points will be 
completely ignored in this process.
Series Capacitor Bypass or Inservice
SERIESCAP | bus1# bus2# ckt | BYPASS
| INSERVICE
Bypasses a series capacitor, or puts it in service. Note: bus# values may be replaced by a string enclosed in 
single quotes where the string is the name of the bus followed by and underscore character and then the 
nominal voltage of the bus. Note: bus# values may also be replaced by a string enclosed in single quotes 
which represents the label of the bus. Also, the entire sequence [bus1# bus2# ckt] may be replaced by 
the label of the branch. Keyword SERIESCAP may also be replaced with BRANCH, which will allow 
bypassing or not bypassing any branch and is not limited to series capacitors.
Series Capacitor set impedance
SERIESCAP | bus1# bus2# ckt | SET_X_TO | value | PERCENT | REF
| | | PU |
Changes the impedance a series capacitor either specifying a new per unit value or specifying a 
percentage of the value in the contingency reference case. Note: bus# values may be replaced by a string 
enclosed in single quotes where the string is the name of the bus followed by and underscore character 
and then the nominal voltage of the bus. Note: bus# values may also be replaced by a string enclosed in 
single quotes which represents the label of the bus. Also, the entire sequence [bus1# bus2# ckt] may be 
replaced by the label of the branch. Keyword SERIESCAP may also be replaced with BRANCH, which will 
allow setting the impedance of any branch and is not limited to series capacitors.
DC Transmission or VSC DC Transmission Line outage
DCLINE | bus1# bus2# ckt | OPEN
| OPENCBS
VSCDCLINE | 'Name' | OPEN
| OPENCBS
Takes DC Line or VSC DC Line out of service. Note: bus# values may be replaced by a string enclosed in 
single quotes where the string is the name of the bus followed by an underscore character and then the 
nominal voltage of the bus. These values may also be replaced by a string enclosed in single quotes 
176
which represents the label of the bus. Also, the entire sequence [bus1# bus2# ckt] may be replaced by 
the label of the dc transmission line. For the VSC DC Line, the identifiers are replaced simply with the 
name of the VSCDCLINE instead.
DC Line set a specific value or insertion
DCLINE | bus1# bus2# ckt | SET_P_TO | value | MW | REF
| CHANGE_P_BY | | PERCENT
| SET_I_TO | | AMPS
| CHANGE_I_BY |
| CLOSE |
| CLOSECBS |
| SET_TO | value | OHMS | REF
VSCDCLINE | 'Name' | Same options as for the DC Line, except that
 the AMPS option are not avalailable for VSC
Use to set the DC Line setpoint to a particular value, or puts it in service. Note: bus# values may be 
replaced by a string enclosed in single quotes where the string is the name of the bus followed by an 
underscore character and then the nominal voltage of the bus. Note: bus# values may also be replaced 
by a string enclosed in single quotes which represents the label of the bus. Also, the entire sequence 
[bus1# bus2# ckt] may be replaced by the label of the dc transmission line. (Note: for the CLOSE and 
CLOSECBS choice, only the units of MW or AMPS may be used.) For the VSC DC Line, the identifiers are 
replaced simply with the name of the VSCDCLINE instead.
MTDC Converter outage
DCCONVERTER | rec# bus# | OPEN
| OPENCBS
Takes multi-terminal DC converter out of service. The rec# specifies the multi-terminal DC line record, 
while bus# specifies the AC bus to which the converter is connected. Note: bus# values may be replaced 
by a string enclosed in single quotes where the string is the name of the bus followed by an underscore 
character and then the nominal voltage of the bus. These values may also be replaced by a string 
enclosed in single quotes which represents the label of the bus.
MTDC Converter set a specific value or insertion
DCCONVERTER | rec# bus# | SET_P_TO | value | MW | REF
| CHANGE_P_BY | | PERCENT
| SET_I_TO | | AMPS
| CHANGE_I_BY |
| CLOSE |
| CLOSECBS |
Use to set the multi-terminal DC converter setpoint to a particular value, or puts it in service. The rec# 
specifies the multi-terminal DC line record, while bus# specifies the AC bus to which the converter is 
connected. Note: bus# values may be replaced by a string enclosed in single quotes where the string is 
the name of the bus followed by an underscore character and then the nominal voltage of the bus. Note: 
bus# values may also be replaced by a string enclosed in single quotes which represents the label of the 
bus. (Note: for the CLOSE and CLOSECBS choice, only the units of MW or AMPS may be used.)
Phase Shifter set a specific value
PHASESHIFTER | bus1# bus2# ckt | SET_P_TO | value | MW | REF
| CHANGE_P_BY | | PERCENT
| SET_TO | value | DEG | REF
| CHANGE_BY | | |
Use the MW and PERCENT options to change or set the middle of the phase shifter MW regulation range 
to the specified value. Use the DEG option to change or set the phase shift angle in degrees to a particular 
value.
Note: bus# values may be replaced by a string enclosed in single quotes where the string is the name of 
the bus followed by an underscore character and then the nominal voltage of the bus. These values may 
177
also be replaced by a string enclosed in single quotes which represents the label of the bus. Also, the 
entire sequence [bus1# bus2# ckt] may be replaced by the label of the branch.
Keyword PHASESHIFTER may also be replaced with BRANCH. If the branch is not a phase shifter, no 
change will be made. 
3-Winding Transformer outage or insertion
3WXFORMER | bus1# bus2# bus3# ckt | OPEN
| CLOSE
| OPENCBS
| CLOSECBS
Takes all three windings of a 3-winding transformer out of service, or puts them in service. Note: bus# 
values may be replaced by a string enclosed in single quotes where the string is the name of the bus 
followed by an underscore character and then the nominal voltage of the bus. Note: bus# values may 
also be replaced by a string enclosed in single quotes which represents the label of the bus. Also, the 
entire sequence [bus1# bus2# bus#3 ckt] may be replaced by the label of the three winding transformer.
Area Control Type Change
AREA | area# | SET_TO | 'OFF'
| 'PARTFAC'
| 'AREASLACK bus#'
| 'IGSLACK injectiongroup name'
Specify to change the make-up power for an area so that it is different during a contingency than the area 
control settings used in the reference case. The area may be set to toggle the control setting to OFF, 
PARTFAC, AREASLACK, and IGSLACK. The Area Control topic provides more information about these 
control types. If selecting Area Slack is chosen, then a bus must be specified which will act as the area 
slack during the contingency action. If selecting IG Slack, then an injection group must be specified by 
name.
Note: bus# values may be replaced by a string where the string is the name of the bus followed by an 
underscore character and then the nominal voltage of the bus. Note: bus# values may also be replaced 
by a string which represents the label of the bus.
In order for the Area contingency action to work correctly, there are contingency and power flow solution 
options that must be set correctly. Simulator does not automatically set these options so the user must 
make sure they are set. 
• Area control must be enabled in the contingency base case, i.e. the Power Flow Solution Option 
for Island-Based AGC must be set to Disable (Use the Area and Super Area Dispatch settings). 
• The contingency Make-Up Power option must be set to Same as Power Flow case. 
• The option to Disable Automatic Generation Control (AGC) found with the Power Flow Solution 
Options must NOT be selected. 
Another suggestion, although not a strict requirement, is that the area should be on area control prior to 
contingency analysis if a control type other than Off AGC is going to be set during a contingency. If a 
large ACE exists in the base case with area control off, switching the area on control during the 
contingency will zero out the ACE in addition to compensating for required make-up power.
Substation outage
SUBSTATION | sub# | OPEN
| OPENCBS
| SET_P_TO | value | MW | REF
| CHANGE_P_BY | | PERCENT
OPEN and OPENCBS will take a substation out of service. The set and change actions will set the MW 
output of online generators in the substation to the specified value. sub# is the number that identifies the 
178
substation. sub# can be replaced by a string enclosed in single quotes where the string is the name or 
label of the substation.
Abort
ABORT
Include this action to cause the solution of the contingency to be aborted.
Execute a Power Flow Solution
SOLVEPOWERFLOW
Include this action to cause the solution of the contingency to be split into pieces. Actions that are listed 
before each SOLVEPOWERFLOW call will be performed as a group.
Calling of a name ContingencyBlock
CONTINGENCYBLOCK | name
Calls a ContingencyBlock and executes each of the actions in that block.
Make-Up Power Compensation
Only valid immediately following a SET, CHANGE, OPEN or CLOSE action on a Generator, Shunt or Load. 
This describes how the change in MW or MVAR are picked up by buses throughout the system. The values 
specify participation factors. Note: bus# values may be replaced by a string enclosed in single quotes 
where the string is the name of the bus followed by and underscore character and then the nominal 
voltage of the bus.
COMPENSATION
bus#1 value1
bus#2 value2
...
END
Example:
<SUBDATA CTGElement>
 // just some comments 
 // action Model Criteria Status TimeDelay comment
 "BRANCH 40821 40869 1 OPEN" "" ALWAYS 0 //Raver - Paul 500 kV
 "GEN 45041 1 OPEN" "" ALWAYS 0 //Trip Unit #2
 "BRANCH 42702 42727 1 OPEN" "Line X Limited" CHECK 0 //Open Fern Hill 
 "GEN 40221 1 OPEN" "Interface L1" CHECK 0 //Drop ~600 MW
 "GEN 40227 1 OPEN" "Interface L2" CHECK 0 //Drop ~1200 MW 
 "GEN 40221 1 OPEN" "Interface L3" CHECK 0 //Drop ~600 MW 
</SUBDATA>
Note: ContingencyElement object types can also be directly created inside their own DATA section as well. 
One of the key fields of the object is then the name of the contingency to which the ContingencyElement 
belongs. The Action string will remain the same.
179
LimitViol
A LimitViol is used to describe the results of a contingency analysis run. Each Limit Violation lists nine
possible values:
ViolType : One of six values describing the type of violation.
BAMP : branch amp limit violation
BMVA : branch MVA limit violation
VLOW : bus low voltage limit violation
VHIGH : bus high voltage limit violation
INTER : interface MW limit violation
CUSTOM : Custom Monitor value 
ViolElement : This field depends on the ViolType. 
for VLOW, VHIGH : "bus1#" or "busname_buskv" or "buslabel"
for INTER : "interfacename" or "interfacelabel"
for BAMP, BMVA : "bus1# bus2# ckt violationbus# 
MWFlowDirection"
violationbus# is the bus number for the end of the branch which is 
violated
MWFlowDirection is the direction of the MW flow on the line. 
Potential values are "FROMTO" or "TOFROM".
Note: each bus# may be replaced with the name underscore nominal 
kV string enclosed in single quotations. Or bus# values may be 
replaced by a string enclosed in single quotes representing the label 
of the bus. Also the entire sequence [bus1# bus2# ckt] may be 
replaced by the label of the branch.
for CUSTOM : "custommonitorname deviceidentifier" where the 
deviceidentifier will use the key fields or label as 
specified by the option selected when saving
Limit : This is the numerical limit which was violated.
ViolValue : This is the numerical value of the violation.
PTDF : This field is optional. It only makes sense for interface or branch 
violations. It stores a sensitivity of the flow on the violating element 
during in the base case with respect to a transfer direction This must be 
calculated using the Contingency Analysis Other Actions related to 
Sensitivities.
OTDF : Same as for the PTDF.
InitialValue : This stores a number. This stores the base case value for the element 
which is being violated. This is used to compare against when looking at 
change violations.
Reason : This will say whether this was a pure violation, or is being reported as a 
violation because the change from the base case is higher than a 
specified threshold.
LIMIT : means this is a violation of a line/interface/bus limit or 
simply a Custom Monitor
CHANGE : means this is being reported as a limit because the change 
from the initial value is higher than allowed
CTG Specified Limit : This specifies if the Limit originated from a contingency action or from 
the rating specified with the line and Limit Monitoring Settings.
NO : the Limit originated from the line and Limit Monitoring Settings
YES : the Limit originated from a contingency action
180
Example:
<SUBDATA LimitViol>
 BAMP "1 3 1 1 FROMTO" 271.94031 398.48096 10.0 15.01 //Note OTDF/PTDF
 // values can also be specified with name underscore nominal kV string 
 // enclosed inside a single quote as shown next
 BAMP "'One_138' 'Three_138' 1 1 FROMTO" 271.94031 398.48096 10.0 15.01 
 INTER "Right-Top" 45.00000 85.84451 None None 56.000 LIMIT NO
</SUBDATA>
ViolationCTG object types can also be directly created inside their own DATA section as well. One of the 
key fields of the object is then the name of the contingency to which the ViolationCTG belongs.
Sim_Solution_Options
These describe the power flow solution options which should be used under this particular contingency. 
The format of the subdata section is two lines of text. The first line is a list of the fieldtypes for 
Sim_Solution_Options which should be changed. The second line is a list of the values. Note that in 
general, power flow solution options are stored at three different locations in contingency analysis. When 
implementing a contingency, Simulator gives precendence to these three locations in the following order:
1. Contingency Record Options (stored with the particular contingency).
2. Contingency Tool Options (stored with CTG_Options).
3. The global solution options.
WhatOccurredDuringContingency
Each line of this subdata section is part of a text description of what actually ended up being 
implemented for this contingency. This will list which actions were executed and which actions ended up 
being skipped because of their model criteria. Each line of the subdata section must be enclosed in 
quotes.
Example:
<SUBDATA WhatOccurredDuringContingency>
 "Applied: "
 " OPEN Branch Two (2) TO Five (5) CKT 1 | | CHECK | | ELEMENT"
</SUBDATA>
ContingencyMonitoringException
Each line of this subdata section contains a string identifying a specially handled monitored element for 
this contingency followed by a string indicating how this monitored element should be handled with this 
contingency. The elements can be identified by their primary or secondary key fields or by label. The 
element descriptions should be enclosed in quotes because they contain spaces. 
Example:
<SUBDATA ContingencyMonitoringException>
 "Branch '2' '3' '1'" "Exclude"
 "Branch 'Three_138.00' 'Four_138.00'" "Include"
 "Branch 'Line_2_5'" "Default"
</SUBDATA>
CTG_Options
Sim_Solution_Options
These describe the power flow solution options which should be used under this particular contingency. 
The format of the subdata section is two lines of text. The first line is a list of the fieldtypes for 
Sim_Solution_Options which should be changed. The second line is a list of the values. Note that in 
general, power flow solution options are stored at three different locations in contingency analysis. When 
implementing a contingency, Simulator gives precendence to these three locations in the following order:
1. Contingency Record Options (stored with the particular contingency).
2. Contingency Tool Options (stored with CTG_Options).
181
3. The global solution options.
CTGElementBlock
CTGElement
This format is the same as for the Contingency objecttype, however, you cannot call a ContingencyBlock 
from within a contingencyblock.
CTGElementAppend
When a subdata section is defined as CTGElementAppend rather than CTGElement, the actions of this 
subdata section will be appended to the contingency actions, instead of replacing them. This format is 
the same as for the Contingency objecttype, however, you cannot call a ContingencyBlock from within a 
contingencyblock.
Note: CTGElementBlockElement object types can also be directly created inside their own DATA section as 
well. One of the key fields of the object is then the name of the contingency block to which the 
CTGElementBlockElement belongs.
CustomColors
CustomColors
These describe the customized colors used in Simulator, which are specified by the user. A custom color 
is an integer describing a color. Each custom color is written on a single line of text and is an integer 
between 0 and 16,777,216. The value is determined by taking the red, green, and blue components of the 
color and assigning them a value between 0 and 255. The color is then equal to red + 256*green + 
256*256*blue. Each line contains only one integer that corresponds to the color specified.
Example:
<SUBDATA CustomColors>
 9823301
 8613240
</SUBDATA> 
CustomCaseInfo
ColumnInfo
Each line of this SUBDATA section can be used for specifying the column width of particular columns of 
the respective Custom Case Information Sheet. The line contains two values – the column and then a 
column width. This is shown in the following example.
Example:
<SUBDATA ColumnInfo>
 "SheetCol" 133
 "SheetCol:1" 150
 "SheetCol:2" 50
</SUBDATA> 
DataGrid
ColumnInfo
Contains a description of the columns which are shown in the respective data grid. Each line of text 
contains at least four fields: VariableName, ColumnWidth, TotalDigits, DecimalPoints. The remaining 
fields are used when showing a Data View based on this DataGrid object. See help website for Data View 
or the OpenDataView script command for more information about this.
Variablename : Contains the variable which is shown in this column.
182
ColumnWidth : The column width.
TotalDigits : The total digits displayed for numerical values.
DecimalPoints : The decimal points shown for numerical values.
TabBreak : Optional. Default to NO. Set to YES to indicate that a new tab should be 
started immediately before this field.
TabCaption : Optional. Default to blank string. Specifies a caption for the tabbed 
control for fields occurring after the Tab Break.
RowBreak : Optional. Default to NO. Set to YES to indicate that a new row should be 
started immediately before this field.
RowCaption : Optional. Default to blank string. Specifies a caption for a group box for 
the fields occurring after the row break.
ColBreak : Optional. Default to NO. Set to YES to indicate that a new Column 
should be started immediately before this field. Also, a special feature 
for column breaks only is you may specify a number after YES to indicate 
multiple column breaks to skip over a column. For example "YES 2" to 
skip a column because there are 2 consecutive column breaks.
RowCaption : Optional. Default to blank string. Specifies a caption for a group box for 
the fields occurring after the column break.
Example:
DataGrid (DataGridName)
{
 BUS 
 <SUBDATA COLUMNINFO>
 BusNomVolt 100 8 2
 AreaNum 50 8 2 "YES" "Tab Caption" "NO" "" "NO" ""
 ZoneNum 50 8 2
 </SUBDATA>
 BRANCHRUN
 <subdata COLUMNINFO >
 BusNomVolt:0 100 8 2
 BusNomVolt:1 100 8 2 "NO" "" "NO" "" "YES 2" "Col Caption"
 LineMW:0 100 9 3 "NO" "" "YES" "Row Caption" "NO" "" 
 </SUBDATA>
}
ColumnContourInfo
Contains a description of the column contour settings
ColumnNumber : Contains the column index of the contoured column
UseAbsValue : Contour the absolute value if YES. If NO then contour the signed value.
IgnoreValuesAbove : If YES values above the maximum percentage are ignored.
IgnoreValuesBelow : if YES values below the minimum percentage are ignored.
AbsMin : The minimum value for the colormap
LimMin : The break low value for the colormap
Nominal : The nominal value for the colormap
LimMax : The break high value for the colormap
AbsMax : The maximum value for the colormap
ColorMapName : The name of the color map the contour is using. This must reference a 
color map that exists in the case.
ColorMapBrightness : The brightness or color saturation. The values range from -0.8 (darker) to 
0.8 (brigher).
ColorMapReverseColors : If YES, the colors in the colormap will be reversed.
183
Example:
DATA (DataGrid, 
[DataGridName,BGDisplayFilter,FilterName,NonDefaultFont,CaseInfoRowHeight,FontName,Fon
tStyles,SOFontSize,FontColor,VariableName,ConditionType,ViewZoomLevel,FrozenColumns])
{
"Bus" "YES" "" "YES" 13 "Segoe UI" "" 8 0 "" "High To Low" 100.00 -1
 <SUBDATA ColumnInfo>
 "BusNum" 75 8 2
 "BusName" 75 8 2
 "AreaName" 75 8 2
 "BusNomVolt" 75 8 2
 "BusPUVolt" 75 8 5
 "BusKVVolt" 75 8 3
 "BusAngle" 75 8 2
 </SUBDATA>
 <SUBDATA ColumnContourInfo>
 5 NO NO NO 0.996563732624054 1.01118695735931 1.02581024169922 
1.03790521621704 1.05000007152557 "Blue=low, Red=High" 0 NO 
 7 NO NO NO -1.17415904998779 0.0616339445114136 1.29742693901062 
3.84944224357605 6.4014573097229 "Discrete 20 Red/Blue" 0 NO 
 </SUBDATA>
}
DynamicFormatting
DynamicFormattingContextObject
This subdata section contains a list of the display object types which are chosen to be selected. Each line 
of the section consists of the following:
DisplayObjectType (WhichFields) (ListOfFields)
DisplayObjectType : The object type of the display object. These are generally the same as 
the values seen in the subdata section SelectByCriteriaSetType of 
SelectByCriteriaSet object types. The only exception is the string 
CaseInfo, which is used for formatting applying to the case information 
displays.
(WhichFields) : For display objects that can reference different fields, this sets which of 
those fields it should select (e.g. select only Bus Name Fields). The value 
may be either ALL or SPECIFIED.
(ListOfFields) : If WhichFields is set to SPECIFIED, then a delimited list of fields follows.
Example:
<SUBDATA DynamicFormattingContextObject>
 // Note: CaseInfo applies to case information displays
 CaseInfo "SPECIFIED" BusName 
 DisplayAreaField "ALL"
 DisplayBus
 DisplayBusField "SPECIFIED" BusName BusPUVolt BusNum
 DisplayCircuitBreaker
 DisplaySubstation
 DisplaySubstationField "SPECIFIED" SubName SubNum BusNomVolt BGLoadMVR
 DisplayTransmissionLine
 DisplayTransmissionLineField "ALL"
</SUBDATA>
184
LineThicknessLookupMap
LineColorLookupMap
FillColorLookupMap
FontColorLookupMap
FontSizeLookupMap
BlinkColorLookupMap
XoutColorLookupMap
FlowColorLookupMap
SecondaryFlowColorLookupMap
The values of the lookup table for the characteristics that can be modified by the dynamic formatting tool. 
The first line contains the two following fields:
fieldname : It is the field that the lookup table is going to look for.
usediscrete : Set to YES or NO. If set to YES, the characteristic values will be discrete, 
meaning that the characteristic value will correspond exactly to the one 
specified in the table. If set to NO, the characteristic values will be 
continuous, which means the characteristic value will be an interpolation 
of the high and low closest values specified in the table.
The following lines contain two fields:
fieldvalue : The value for the field.
characteristicvalue : The corresponding characteristic value for such field value.
Example:
<SUBDATA LineColorLookupMap>
 // FieldName UseDiscrete
 BusPUVolt YES
 // FieldValue Color
 1.02 16711808
 1.05 8454143
 1.1 16744703
</SUBDATA>
185
Filter
Condition
Conditions store the conditions of the filter. Each condition is described by one line of text which can 
contain up to five fields:
variablename : It is one of the fields for the object_type specified. It may optionally be 
followed by a colon and a non-negative integer. If not specified, 0 is 
assumed.
Example: on a LINE, 0 = from bus, 1 = to bus
sgLineMW:0 = the MW flow leaving the from bus
sgLineMW:1 = the MW flow leaving the to bus
Note: this value may also be the string "_UseAnotherfilter" which would 
then be followed by either meets or notmeets and then the name of 
another Filter.
Condition : Possible Values Alternate1 Alternate2 Requires 
othervalue
between >< yes
notbetween ~>< yes
equal = ==
notequal <> ~=
greaterthan >
lessthan <
greaterthanorequal >=
lessthanorequal <=
about yes
notabout yes
contains
notcontains
startswith
notstartswith
inrange
notinrange
meets
notmeets
isblank
notisblank
value : The value used for comparison.
For fields associated with strings, this must be a string.
For fields associated with real numbers, this must be a number.
For fields associated with integers, this is normally an integer, except 
when the Condition is "inrange" or "notinrange". In this case, value is a 
comma/dash separated number string.
(othervalue) : If required, the other value used for comparison. For conditions "about" 
and "notabout" this is the tolerance with which the value should be equal 
or not equal.
(FieldOpt) : Optional string with following meanings. Unspecified means that strings 
are case insensitive, use number fields directly (older files may have had 
an integer 0 as well).
ABS : strings are case sensitive, take absolute value of field values 
(older files may have had an integer 1 as well)
186
Example:
FILTER (objecttype, filtername, filtertype, prefilter)
{
BUS "a bus filter" "AND" "no"
 <SUBDATA CONDITION>
 BusNomVolt > 100
 AreaNum inrange "1 – 5 , 7 , 90-95"
 ZoneNum between
 </SUBDATA>
BRANCH "a branch filter" "OR" "no"
 <subdata CONDITION>
 BusNomVolt:0 > 100 // Note location 0 means from bus
 BusNomVolt:1 > 100 // Note location 1 means to bus
 LineMW:0 > 100 1 // Note, final field 1 denotes absolute value
 _UseAnotherFilter meets 
 </SUBDATA>
}
Gen
BidCurve
BidCurve subdata is used to define a piece-wise linear cost curve (or a bid curve). Each bid point consists 
of two real numbers on a single line of text: a MW output and then the respective bid (or marginal cost).
Example:
<SUBDATA BidCurve>
 // MW Price[$/MWhr]
 100.00 10.6
 200.00 12.4
 400.00 15.7
 500.00 16.0
</SUBDATA>
ReactiveCapability
Reactive Capability subdata is used to the reactive capability curve of the generator. Each line of text 
consists of three real numbers: a MW output, and then the respective Minimum MVAR and Maximum 
MVAR output.
Example:
<SUBDATA ReactiveCapability>
 // MW MinMVAR MaxMVAR
 100.00 -60.00 60.00
 200.00 -50.00 50.00
 400.00 -30.00 20.00
 500.00 - 5.00 2.00
</SUBDATA>
Note: ReactiveCapability object types can also be directly created inside their own DATA section as well. 
Two of the key fields of the object are then the bus number and generator ID of the generator to which 
the ReactiveCapability point belongs.
187
GeoDataViewStyle
TotalAreaValueMap
This subdata section is used to define the lookup table for determining the total area size of geographic 
data view objects based on the value of a selected field. Two values are entered for each mapping:
FieldValue : Value of the field selected for the Total Area attribute.
TotalArea : The total area size of the object.
Example:
<SUBDATA TotalAreaValueMap>
// FieldValue TotalArea
1.000 0
4.000 23
7.000 46
</SUBDATA>
RotationRateValueMap
This subdata section is used to define the lookup table for determining the rotation rate of geographic 
data view objects based on the value of a selected field. Two values are entered for each mapping:
FieldValue : Value of the field selected for the Rotation Rate attribute.
RotationRate : The rotation rate of the object. Entered in Hz.
Example:
<SUBDATA RotationRateValueMap>
// FieldValue RotationRate
1.000 0.00
4.000 0.10
7.000 0.20
</SUBDATA>
RotationAngleValueMap
This subdata section is used to define the lookup table for determining the rotation angle of geographic 
data view objects based on the value of a selected field. Two values are entered for each mapping:
FieldValue : Value of the field selected for the Rotation Angle attribute.
RotationAngle : The rotation angle of the object. Entered in degrees.
Example:
<SUBDATA RotationAngleValueMap>
// FieldValue RotationAngle
1.000 -90.0
4.000 0.0
7.000 90.0
</SUBDATA>
188
LineThicknessValueMap
This subdata section is used to define the lookup table for determining the thickness of the border line 
around geographic data view objects based on the value of a selected field. Two values are entered for 
each mapping:
FieldValue : Value of the field selected for the Line Thickness attribute.
LineThickness : The line thickness of the border line around the object. This should be an 
integer value.
Example:
<SUBDATA LineThicknessValueMap>
// FieldValue LineThickness
1.000 1
4.000 2
7.000 3
</SUBDATA>
GlobalContingencyActions
CTGElementAppend
This format is the same as for the Contingency objecttype except that the SolvePowerFlow action is not 
allowed.
CTGElement
This format is the same as for the Contingency objecttype except that the SolvePowerFlow action is not 
allowed.
Note: GlobalContingencyActionsElement object types can also be directly created inside their own DATA 
section as well. 
HintDefValues
HintObject
Stores the values for the custom hints. Each line has one value:
FieldDescription : This is a string enclosed in double quotes. The string itself is delimited 
by the @ character. The string contains five values:
Name of Field : The name of the field. Special fields that appear on 
dialog by default have special names. Otherwise 
these are the same as the fieldnames of the AUX file 
format (for the "other fields" feature on the dialogs).
Total Digit : Number of total digits for a numeric field.
Decimal Points : Number of decimal points for a numeric field.
Include Suffix : Set to 0 for not including the suffix, and set to 1 to 
include it.
Field Preffix : The prefix text.
Example:
<SUBDATA HintObject>
 "BusPUVolt@4@1@1@PU Volt ="
 "BusAngle@4@1@1@Angle ="
</SUBDATA>
189
InjectionGroup
PartPoint
A participation point is used to describe the contents of an injection group. Each participation point lists 
six values:
PointType : One of five values describing the type of point.
GEN : a generator
LOAD : a load
SHUNT : a switched shunt
BUS : a bus
INJECTIONGROUP: another injection group
PointBusNum : The bus number of the partpoint if the type is a GEN, LOAD, SHUNT, or 
BUS. Value will be blank for an injection group type. Note: bus# values 
may be replaced by a string enclosed in double quotes where the string 
is the name of the bus followed by an underscore character and then the 
nominal voltage of the bus. These values may also be replaced by a 
string enclosed in double quotes that represents the label of the bus or a 
string representing the label of the generator, load, or switched shunt.
PointID : For GEN, LOAD, or SHUNT type, this is the id for the partpoint. For an 
INJECTIONGROUP type, this is the name or label of the injection group. 
This is blank for a BUS type.
PointParFac : The participation factor for the point.
ParFacCalcType : How the participation factor is calculated. There are several options 
depending on the PointType. 
Generators : SPECIFIED, MAX GEN INC, MAX GEN DEC, or MAX 
GEN MW
Loads : SPECIFIED or LOAD MW
Shunts : SPECIFIED, MAX SHUNT INC, MAX SHUNT DEC, or 
MAX SHUNT MVAR
Bus : SPECIFIED
Injection Groups : SPECIFIED
All PointTypes can also set their participation factor based on a field 
associated with the device. To specify this, the tag <Field> should be 
followed by the variable name of the field: <Field>variablename. All 
PointTypes can also set their participation factor based on a Model 
Expression. To specify this, the tag <Expression> should be followed 
by the name of the Model Expression: <Expression>ModelExpression. 
ParFacNotDynamic : Should the participation factor be recalculated dynamically as the system 
changes.
Example:
<SUBDATA PartPoint>
 "GEN" 1 "1" 1.00 "SPECIFIED" "NO"
 "GEN" 4 "1" 104.96 "MAX GEN INC" "NO"
 "GEN" 6 "1" 50.32 "MAX GEN DEC" "YES"
 "GEN" 7 "1" 600.00 "MAX GEN MW" "NO"
 "LOAD" 2 "1" 5.00 "SPECIFIED" "NO"
 "LOAD" 6 "1" 200.00 "LOAD MW" "YES"
</SUBDATA>
Note: PartPoint object types can also be directly created inside their own DATA section as well. One of 
the key fields of the PartPoint object is then the name of the injection group to which the participation 
point belongs.
190
Interface
InterfaceElement
A interfaces’s subdata contains a list of the elements in the interface. Each line contains a text 
descriptions of the interface element. Note that this text description must be encompassed by quotation 
marks. There are eleven kinds of elements allowed in an interface. Please note that the direction 
specified in the monitoring elements is important.
"BRANCH num1 num2 ckt"
: Monitor the MW flow on the branch starting from bus num1 going to 
bus num2 with circuit ckt. (order of bus numbers defines the direction)
"AREA num1 num2" : Monitor the sum of the AC branches that connect area1 and area2.
"ZONE num1 num2" : Monitor the sum of the AC branches that connect zone1 and zone2.
"BRANCHOPEN num1 num2 ckt"
: When monitoring the elements in this interface, monitor them under the 
contingency of opening this branch.
"BRANCHCLOSE num1 num2 ckt"
: When monitoring the elements in this interface, monitor them under the 
contingency of closing this branch.
"DCLINE num1 num2 ckt"
: Monitor the flow on a DC line.
"INJECTIONGROUP 'name'"
: Monitor the net injection from an injection group (generation contributes 
as a positive injection, loads as negative).
"GEN num1 id" : Monitor the net injection from a generator (output is positive injection)
"LOAD num1 id" : Monitor the net injection from a load (output is negative injection).
"MSLINE num1 num2 ckt"
: Monitor the MW flow on the multi-section line starting from bus num1 
going to bus num2 with circuit ckt.
"INTERFACE 'name' " : Monitor the MW flow on the interface given by name.
"GENOPEN num1 id" : When monitoring the elements in this interface, monitor them under the 
contingency of opening this generator.
"LOADOPEN num1 id": When monitoring the elements in this interface, monitor them under the 
contingency of opening this load.
Note: bus# values may be replaced by a string enclosed in single quotes where the string is the name of 
the bus followed by an underscore character and then the nominal voltage of the bus. Labels may also be 
use as follows.
• bus# values for all element types may be replaced by a string enclosed in single quotes where the 
string is the label of the bus. 
• for GEN or LOAD elements, the section num1 id may be replaced by the device’s label.
• For MSLINE, DCLINE, or BRANCH elements, the num1 num2 ckt section may be replaced by the 
device’s label.
For the interface element type BRANCH num1 num2 ckt and DCLINE num1 num2 ckt, an optional 
field can also be written specifying whether the flow should be measured at the far end. This field is 
either YES or NO.
191
Example:
<SUBDATA InterfaceElement
 "BRANCH 8 9 1" NO // monitor the flow from bus 8 to bus 9 on this branch
 "BRANCH 12 33 1" YES // monitor the flow from bus 12 to bus 33 on branch
 // measurefarend is set to true, therefore, we are 
// monitoring the MW flow that arrives at bus 33
 // the following demonstrates the format when bus names and
 // nominal voltages are used. 
 "BRANCH 'Twelve_230' 'name33_230' 1" YES
 
 "AREA 2 1" // monitor tie line flow from area 2 to area 1
 "ZONE 66 53" // monitor tie lines flows from zone 66 to zone 53
 "BRANCHOPEN 5 6 1" // does monitoring after branch opens
 "BRANCHCLOSE 7 10 1" // does monitoring after branch closes
 "GENOPEN" 55 1" // does monitoring after generator opens
</SUBDATA>
Note: InterfaceElement object types can also be directly created inside their own DATA section as well. 
One of the key fields of the InterfaceElement object is then the name of the interface to which the 
interface element belongs.
KMLExportFormat
DataBlockDescription
This subdata section is used to describe the objects and fields that should be saved to a KML file. Same 
format as for the AUXFileExportFormatData subdata section. 
LimitSet
LimitCost
LimitCost records describe the piece-wise unenforceable constraint cost records for use by unenforceable 
line/interface limits in the OPF or SCOPF. Each row contains two values
PercentLimit : Percent of the transmission line limit.
Cost : Cost used at this line loading percentage value.
Example:
<SUBDATA LimitCost>
 //Percent Cost [$/MWhr]
 100.00 50.00
 105.00 100.00
 110.00 500.00
</SUBDATA>
Load
BidCurve
BidCurve subdata is used to define a piece-wise linear benefit curve (or a bid curve). Each bid point 
consists of two real numbers on a single line of text: a MW output and then the respective bid (or 
marginal cost). These costs must be increasing for loads.
Example:
<SUBDATA BidCurve>
 // MW Price[$/MWhr]
 100.00 16.0
 200.00 15.7
 400.00 12.4
 500.00 10.6
</SUBDATA>
192
LPVariable
LPVariableCostSegment
Stores the cost segments for the LP variables. Each line contains four values:
Cost (Up) : Cost associated with increasing the LP variable.
Minimum value : Minimum limit of the LP variable.
Maximum value : Maximum limit of the LP variable.
Artificial : Whether the cost segment is artificial or not.
Example:
<SUBDATA LPVariableCostSegment>
 //Cost(Up) Minimum Maximum Artificial
 -20000.0000 -10000000000.5801 -0.6000 YES
 16.2343 -0.6000 0.0000 NO 
 16.5526 0.0000 0.6000 NO 
 16.8708 0.6000 1.2000 NO 
 17.1890 1.2000 1.8000 NO 
 17.5073 1.8000 2.4000 NO 
 20000.0000 2.4000 9999999999.4199 YES
</SUBDATA>
ModelCondition
Condition
ModelConditions are the combination of an object and a Filter. They are used to return when the 
particular object meets the filter specified. As a result, the subdata section here mostly identical to the 
Condition subdata section of a Filter. See the description there. There is one exception however with the 
FieldOpt which has additional strings
(FieldOpt) : Optional string with following meanings:
ABS : strings are case sensitive, take ABS of field values (older files 
may have had an integer 1 as well)
REF : Means that the variablename is evaluated in the contingency 
reference state
ABSREF : means that both ABS and REF are being used 
Nothing specified means that strings are case insensitive, use number 
fields directly and values are evaluated as normal (older files may have 
had an integer 0 as well)
ModelExpression
LookupTable
LookupTables are used inside Model Expressions sometimes. These lookup table represent either one or 
two dimensional tables. If the first string in the SUBDATA section is "x1x2", this signals that it is a two 
dimensional lookup table. From that point on it will read the first row as "x2" lookup points, and the first 
column in the remainder of the rows as the x1 lookup values. 
193
Example:
MODELEXPRESSION (CustomExpression,ObjectType,CustomExpressionStyle, 
CustomExpressionString,WhoAmI,VariableName,WhoAmI:1,VariableName:1)
{
// The following demonstrated a one dimensional lookup table
22.0000, "oneD", "Lookup", "", "Gen<KEY1>1</KEY1><KEY2>1</KEY2>", 
"Gen<KEY1>1</KEY1><KEY2>1</KEY2><VAR>GenMW</VAR>", "", "" 
 <SUBDATA LookupTable>
 // because it does not start with the string x1x2 this will 
 // represent a one dimensional lookup table
 x1 value
 0.000000 1.000000
 11.000000 22.000000
 111.000000 222.000000
 </SUBDATA>
0.0000, "twod", "Lookup", "", 
"Gen<KEY1>1</KEY1><KEY2>1</KEY2>",
"Gen<KEY1>1</KEY1><KEY2>1</KEY2><VAR>GenMW</VAR>",
"Gen<KEY1>6</KEY1><KEY2>1</KEY2>",
"Gen<KEY1>6</KEY1><KEY2>1</KEY2><VAR>GenMW</VAR>"
 <SUBDATA LookupTable>
 // because this starts with x1x2 this represent a two dimensional
 // lookup table. The first column represents lookup values for x1.
 // The first row represents lookup values for x2
 x1x2 0.100000 0.300000 // these are lookup heading for x2
 0.000000 1.000000 3.000000
 11.000000 22.000000 33.000000
 111.000000 222.000000 333.000000
 </SUBDATA>
}
ModelFilter
ModelCondition
A Model Filter’s subdata contains a list of each ModelCondition in the filter. Because a list of Model 
Conditions is stored within Simulator, this subdata section only requires the name of each 
ModelCondition on each line and whether or not the condition is using the NOT operator as part of the 
Model Filter.
Example:
<SUBDATA ModelCondition>
// ModelConditionName NotCondition
 "Name of First Model Condition" "NO"
 "Name of Second Model Condition" "NO"
 "Name of Third Model Condition" "NO"
</SUBDATA>
194
MTDCRecord
An example of the entire multi-terminal DC transmission line record is given at the end of this record description. Each of 
the SUBDATA sections is discussed first.
MTDCBus
For this SUBDTA section, each DC Bus is described on a single line of text with exactly 8 fields specified.
DCBusNum : The number of the DC Bus. Note DC bus numbers are independent AC 
bus numbers.
DCBusName : The name of the DC bus enclosed in quotes.
ACTerminalBus : The AC terminal to which this DC bus is connected (via a 
MTDCConverter). If the DC bus is not connected to any AC buses, then 
specify as zero. You may also specify this as a string enclosed in double 
quotes with the bus name followed by an underscore character, following 
by the nominal voltage of the bus.
DCResistanceToground
: The resistance of the DC bus to ground. Not used by Simulator.
DCBusVoltage : The DC bus voltage in kV.
DCArea : The area that this DC bus belongs to.
DCZone : The zone that this DC bus belongs to.
DCOwner : The owner that this DC bus belongs to.
MTDCBus object types can also be directly created inside their own DATA section as well. One of the key 
fields of the object is then the number of the MTDCRecord to which the MTDCBus belongs.
MTDCConverter
For this SUBDTA section, each AC/DC Converter is described by exactly 24 field which may be spread 
across several lines of text. Simulator will keep reading lines of text until it finds 24 fields. All text to the 
right of the 24th field (on the same line of text) will be ignored. The 24 fields are listed in the following 
order:
BusNum : AC terminal bus number.
MTDCNBridges : Number of bridges for the converter.
MTDCConvEBas : Converter AC base voltage.
MTDCConvAngMxMn : Converter firing angle.
MTDCConvAngMxMn:1
: Converter firing angle max.
MTDCConvAngMxMn:2
: Converter firing angle min.
MTDCConvComm : Converter commutating resistance.
MTDCConvComm:1 : Converter commutating reactance.
MTDCConvXFRat : Converter transformer ratio.
MTDCFixedACTap : Fixed AC tap.
MTDCConvTapVals : Converter tap.
MTDCConvTapVals:1 : Converter tap max.
MTDCConvTapVals:2 : Converter tap min.
MTDCConvTapVals:3 : Converter tap step size.
MTDCConvSetVL : Converter setpoint value (current or power).
MTDCConvDCPF : Converter DC participation factor.
MTDCConvMarg : Converter margin (power or current).
MTDCConvType : Converter type.
MTDCMaxConvCurrent
: Converter Current Rating.
MTDCConvStatus : Converter Status.
MTDCConvSchedVolt : Converter scheduled DC voltage.
195
MTDCConvIDC : Converter DC current.
MTDCConvPQ : Converter real power.
MTDCConvPQ:1 : Converter reactive power.
MTDCConverter object types can also be directly created inside their own DATA section as well. One of 
the key fields of the object is then the number of the MTDCRecord to which the MTDCConverter belongs.
MTDCTransmissionLine
For this SUBDATA section, each DC Transmission Line is described on a single line of text with exactly 5 
fields specified:
DCFromBusNum : From DC Bus Number.
DCToBusNum : To DC Bus Number.
CKTID : The DC Circuit ID.
Resistance : Resistance of the DC Line in Ohms.
Inductance : Inductance of the DC Line in mHenries (Not used by Simulator).
Example:
MTDCRECORD (Num,Mode,ControlBus)
{
//--------------------------------------------------------------------------
// The first Multi-Terminal DC Transmission Line Record
//--------------------------------------------------------------------------
1 "Current" "SYLMAR3 (26098)"
 <SUBDATA Bus>
 //------------------------------------------------------------------- 
 // DC Bus data must appear on a single line of text
 // The data consists of exactly 8 values
 // DC Bus Num, DC Bus Name, AC Terminal Bus, DC Resistance to ground, 
 // DC Bus Voltage, DC Bus Area, DC Bus Zone, DC Bus Owner
 3 "CELILO3P" 0 9999.00 497.92 40 404 1
 4 "SYLMAR3P" 0 9999.00 439.02 26 404 1
 7 "DC7" 41311 9999.00 497.93 40 404 1
 8 "DC8" 41313 9999.00 497.94 40 404 1
 9 "DC9" 26097 9999.00 439.01 26 404 1
 10 "DC10" 26098 9999.00 439.00 26 404 1
 </SUBDATA>
 <SUBDATA Converter>
 //------------------------------------------------------------------- 
 // convert subdata keeps reading lines of text until it has found 
// values specified for 24 fields. This can span any number of lines
// any values to the right of the 24th field found will be ignored
// The next converter will continue on the next line.
 //------------------------------------------------------------------- 
 41311 2 525.00 20.25 24.00 5.00 0.0000 16.3100 
 0.391048 1.050000 1.000000 1.225000 0.950000 0.012500
 1100.0000 1650.0000 0.0000 "Rect" 1650.0000 "Closed" 
 497.931 1100.0000 547.7241 295.3274
 41313 4 232.50 15.36 17.50 5.00 0.0000 7.5130 
 0.457634 1.008700 1.030000 1.150000 0.990000 0.010000
 2000.0000 2160.0000 0.1550 "Rect" 2160.0000 "Closed" 
 497.940 2000.0000 995.8800 561.8186
 26097 2 230.00 20.90 24.00 5.00 0.0000 16.3100 
 0.892609 1.000000 1.100000 1.225000 0.950000 0.012500
 -1100.0000 1650.0000 "" "Inv" 1650.0000 "Closed" 
 439.009 1100.0000 -482.9099 274.5227
 26098 4 232.00 17.51 20.00 5.00 0.0000 7.5130 
 0.458621 1.008700 1.100000 1.120000 0.960000 0.010000
 439.0000 2160.0000 "" "Inv" 2160.0000 "Closed" 
 439.000 1999.9999 -878.0000 544.2775
 </SUBDATA>
 <SUBDATA TransmissionLine>
 //------------------------------------------------------------------- 
 // DC Transmission Segment information appears on a single line of 
 // text. It consists of exactly 5 value
196
 // From DCBus, To DCBus, Circuit ID, Line Resistance, Line Inductance
 //------------------------------------------------------------------- 
 3 4 "1" 19.0000 1300.0000
 7 3 "1" 0.0100 0.0000
 8 3 "1" 0.0100 0.0000
 9 4 "1" 0.0100 0.0000
 10 4 "1" 0.0100 0.0000
 </SUBDATA>
//--------------------------------------------------------------------------
// A second Multi-Terminal DC Transmission Line Record
//--------------------------------------------------------------------------
2 "Current" "SYLMAR4 (26100)"
 <SUBDATA Bus>
 5 "CELILO4P" 0 9999.00 497.92 40 404 1
 6 "SYLMAR4P" 0 9999.00 439.02 26 404 1
 11 "DC11" 41312 9999.00 497.93 40 404 1
 12 "DC12" 41314 9999.00 497.94 40 404 1
 13 "DC13" 26099 9999.00 439.01 26 404 1
 14 "DC14" 26100 9999.00 439.00 26 404 1
 </SUBDATA>
 <SUBDATA Converter>
 41312 2 525.00 20.26 24.00 5.00 0.0000 16.3100 
 0.391048 1.050000 1.000000 1.225000 0.950000 0.012500
 1100.0000 1650.0000 0.0000 "Rect" 1650.0000 "Closed" 
 497.931 1100.0000 547.7241 295.3969
 41314 4 232.50 15.45 17.50 5.00 0.0000 7.5130 
 0.457634 1.008700 1.030000 1.150000 0.990000 0.010000
 2000.0000 2160.0000 0.1550 "Rect" 2160.0000 "Closed" 
 497.940 2000.0000 995.8800 562.9448
 26099 2 230.00 20.90 24.00 5.00 0.0000 16.3100 
 0.892609 1.000000 1.100000 1.225000 0.950000 0.012500
 -1100.0000 1650.0000 "" "Inv" 1650.0000 "Closed" 
 439.009 1100.0000 -482.9099 274.5227
 26100 4 232.00 17.51 20.00 5.00 0.0000 7.5130 
 0.458621 1.008700 1.100000 1.120000 0.960000 0.010000
 439.0000 2160.0000 "" "Inv" 2160.0000 "Closed" 
 439.000 1999.9999 -878.0000 544.2775
 </SUBDATA>
 <SUBDATA TransmissionLine>
 5 6 "1" 19.0000 1300.0000
 11 5 "1" 0.0100 0.0000
 12 5 "1" 0.0100 0.0000
 13 6 "1" 0.0100 0.0000
 14 6 "1" 0.0100 0.0000
 </SUBDATA>
}
MTDCTransmissionLine object types can also be directly created inside their own DATA section as well. 
One of the key fields of the object is then the number of the MTDCRecord to which the 
MTDCTransmissionLine belongs.
MultiSectionLine
Bus
A multi section line’s subdata contains a list of each dummy bus, starting with the one connected to the 
From Bus of the MultiSectionLine and proceeding in order to the bus connected to the To Bus of the Line. 
Note: bus# values may be replaced by a string enclosed in double quotes where the string is the name of 
the bus followed by an underscore character and then the nominal voltage of the bus, or the string may 
represent the label of the bus. 
197
Example:
//------------------------------------------------------------------------
// The following describes a multi-section line that connnects bus 
// 2 - 1 - 5 - 6 - 3
//------------------------------------------------------------------------
MultiSectionLine (BusNum, BusName, BusNum:1, BusName:1,
 LineCircuit, MSLineNSections, MSLineStatus)
{
2 "Two" 3 "Three" "&1" 2 "Closed"
 <SUBDATA Bus>
 1
 5
 6
 </SUBDATA>
}
BusRenumber
This subdata section allows renumbering of the dummy buses. The entries in the subdata section must be 
the new bus number that should be assigned to each dummy bus followed by the name of the new bus. 
The entries can be either space or comma delimited. The bus number must be specified, but the name is 
optional. If the name is not included and a new bus needs to be created, the name will be the same as 
the number. If an incorrect number of dummy buses is entered for a multi-section line, none of the 
dummy buses will be updated for that line. If a dummy bus number is specified that matches an existing 
bus that is another dummy bus, the other dummy bus will be assigned to a new bus number and the 
current dummy bus will be assigned to the number specified in the data.
Example:
MultiSectionLine (BusNum, BusNum:1, LineCircuit) 
{
1 2 "1"
 <SUBDATA BusRenumber>
 3 "Bus 3"
 4 "Bus 4"
 5 "Bus 5"
 </SUBDATA>
22 33 "1"
 <SUBDATA BusRenumber>
 14 "Bus 14"
 15 "Bus 15"
 </SUBDATA>
}
Nomogram
InterfaceElementA
InterfaceElementB
InterfaceElementA values represent the interface elements for the first interface of the nomogram. 
InterfaceElementB values represent the interface elements for the second interface of the nomogram. The 
format of these SUBDATA sections is identical to the format of the InterfaceElement SUBDATA section of a 
normal Interface.
198
NomogramBreakPoint
This subdata section contains a list of the vertex points on the nomogram limit curve.
Example:
<SUBDATA NomogramBreakPoint>
// LimA LimB
 -100 -20
 -100 100
 80 50
 60 -10
</SUBDATA>
NomogramInterface
InterfaceElement
This follows the same convention as the InterfaceElement SUBDATA section described with the Interface 
objecttype.
Owner
Bus
This subdata section contains a list of the buses which are owned by this owner. Each line of text contains 
the bus number. As an alternative to specifying the bus number, a string enclosed in double quotes may 
be used where the string represents the name of the bus followed by an underscore character and then 
the nominal voltage of the bus, or the string may represent the label of the bus.
Example:
<SUBDATA Bus>
 1
 35
 65
</SUBDATA>
Load
This subdata section contains a list of the loads which are owned by this owner. Each line of text contains 
the bus number followed by the load id. As an alternative to specifying the bus number, a string enclosed 
in double quotes may be used where the string represents the name of the bus followed by an 
underscore character and then the nominal voltage of the bus, or the string may represent the label of the 
bus. Also, instead of specifying the bus and load id, the label of the load enclosed in double quotes may 
be used. 
Example:
<SUBDATA Load>
 5 1 // shows ownership of the load at bus 5 with id of 1
 423 1
</SUBDATA>
Gen
This subdata section contains a list of the generators which are owned by this owner and the fraction of 
ownership. Each line of text contains the bus number, followed by the gen id, followed by an integer 
showing the fraction of ownership. As an alternative to specifying the bus number, a string enclosed in 
double quotes may be used where the string represents the name of the bus followed by an underscore 
character and then the nominal voltage of the bus, or the string may represent the label of the bus. Also, 
instead of specifying the bus and generator id, the label of the generator enclosed in double quotes may 
be used.
199
Example:
<SUBDATA Gen>
 78 1 50 // shows 50% ownership of generator at bus 78 with id of 1
 23 3 70
</SUBDATA>
Branch
This subdata section contains a list of the branches which are owned by this owner and the fraction of 
ownership. Each line of text contains the from bus number, followed by the to bus number, followed by 
the circuit id, followed by an integer showing the fraction of ownership. As an alternative to specifying 
the bus numbers, strings enclosed in double quotes may be used where the string represents the name of 
the bus followed by an underscore character and then the nominal voltage of the bus, or the string may 
represent the label of the bus. Also instead of specifying the two numbers and a circuit id, the label of the 
branch enclosed in double quotes may be used.
Example:
<SUBDATA Branch>
 6 10 1 50 // shows 50% ownership of line from bus 6 to 10, circuit 1
</SUBDATA>
PostPowerFlowActions
CTGElementAppend
This format is the same as for the Contingency objecttype except that Abort, ContingencyBlock, and 
SolvePowerFlow actions are not allowed. 
CTGElement
This format is the same as for the Contingency objecttype except that Abort, ContingencyBlock, and 
SolvePowerFlow actions are not allowed. PostPowerFlowActionsElement object types can also be directly 
created inside their own DATA section as well. 
PWCaseInformation
PWCaseHeader
This subdata section contains the Case Description in free-formatted text. Note: as it is read back into 
Simulator all spaces from the start of each line are removed.
PWFormOptions
PieSizeColorOptions
There can actually be several PieSizeColorOptions subdata sections for each PWFormOptions object. The 
first line of each subdata section, the first line of text consist of exactly four values
ObjectName : The objectname of the type of object these settings apply to. Will be 
either be BRANCH or INTERFACE.
FieldName : The fieldname for the pie charts that these settings apply to.
UseDiscrete : Set to YES to use a discrete mapping of colors and size scalars instead of 
interpolating for intermediate values.
UseOtherSettings : Set to YES to default these settings to the BRANCH MVA values for 
BRANCH object. This allows you to apply the same settings to all pie 
charts.
After this first line of text, if the UseOtherSettings Value is NO, then another line of text will contain 
exactly three values: 
ShowValue : This is the percentage at which the value should be drawn on the pie 
chart.
200
NormalSize : This is the scalar size multiplier which should be used for pie charts below 
the lowest percentage specified in the lookup table.
NormalColor : This is the color which should be used for pie charts below the lowest 
percentage specified in the lookup table.
Finally the remainder of the subdata section will contain a lookup table by percentage of scalar and color 
values. This lookup table will consist of consecutive lines of text with exactly three values
Percentage : This is the percentage at which the follow scalar and color should be 
applied.
Scalar : A scalar (multiplier) on the size of the pie charts.
Color : A color for the pie charts.
Example:
<SUBDATA PieSizeColorOptions>
 // ObjectName FieldName UseDiscrete UseOtherSettings
 Branch MVA YES NO 
 // ShowValue NormalSize NormalColor
 80.0000 1.0000 16776960
 // Percentage Scalar Color
 80.0000 1.5000 33023
 100.0000 2.0000 255
</SUBDATA>
<SUBDATA PieSizeColorOptions>
 // ObjectName FieldName UseDiscrete UseOtherSettings
 Branch MW YES YES
</SUBDATA>
PWLPOPFCTGViol
OPFControlSense
OPFBusSenseP
OPFBusSenseQ
This stores the control sensitivities for each contingency violation during OPF/SCOPF analysis. Each line 
contains one value:
Sensitivity : The value of the sensitivity with respect to each control in 
OPFControlSense or with respect to each bus in OPFBusSenseP and 
OPFBusSenseQ.
Example:
<SUBDATA OPFControlSense>
// Value
 1.000441679
 2.447185E-7
 -1.1109307E-6 
 1.6427327E-7 
 0
</SUBDATA>
PWLPTabRow
LPBasisMatrix
This subdata section stores the basis matrix associated with the final LP OPF solution. Each line contains 
two values:
Variable : The basic variable.
Value : The sensitivity of the constraint to the basic variable.
201
Example:
<SUBDATA LPBasisMatrix>
// Var Value
 1 1.00000
 2 1.00000
 5 1.00000
 6 1.00000
</SUBDATA>
PWPVResultListContainer
PWPVResultObject
This subdata section contains the results of a particular PV Curve scenario. The data consists of two 
general sections: the first three rows of text contain the "independent axis" of the PV Curve. The first row 
starts with the string INDNOM and is followed by a list of numbers representing the nominal shift, the 
second row starts with INDEXP and is followed by the export shift, and the third row starts with INDIMP 
and is followed by the import shift. Following after these rows is a list of all the tracked quantities. Each 
tracked quantity row consists of three parts which are separated by the strings ?f= and &v= . The first 
part of the string represents a description of the power system object being tracked, the second part 
represents the field variable name being tracked, and the third contains a list of all the values at the 
various shift levels.
Example:
<SUBDATA PWPVResultObject>
 INDNOM 0.00 500.00 1000.00 1500.00 1750.00 1875.00 1975.00 
 INDEXP 0.00 500.00 1000.00 1500.00 1750.00 1875.00 1975.00 
 INDIMP 0.00 -417.23 -701.58 -890.58 -952.60 -975.35 -990.43 
 Bus '3'?f=BusPUVolt&v= 0.993 0.983 0.964 0.939 0.926 0.919 0.914
 Bus '5'?f=BusPUVolt&v= 1.007 1.000 0.982 0.956 0.940 0.932 0.926
 Gen '4' '1'?f=GenMVR&v= 19.99 245.27 523.62 831.13 986.84 1060.6 1118.7
 Gen '6' '1'?f=GenMVR&v= -6.59 -120.84 -131.37 -39.53 48.35 103.8 154.5
</SUBDATA>
LimitViol
This subdata section contains the limit violations of a particular PV Curve scenario. This subdata section 
would only exist if using the option to monitor limit violations with the PV tool. Each row consists of an 
identifier, either VLOW or VHIGH, to indicate the type of limit violation followed by the bus identifier 
based on the key field identifier chosen. The bus can be identified by number, name and nominal kV 
combination, or label. The bus identifier is followed by the limit in use to identify a voltage violation and 
this is followed by the voltage at the bus.
Example:
<SUBDATA LimitViol>
 VLOW 3 1.00000 0.99017
 VLOW 5 1.00000 0.98245
</SUBDATA>
PVBusInadequateVoltages
This subdata section contains a list of buses that are considered to have inadequate voltages at each 
transfer level for a particular PV Curve scenario. This subdata section would only exist if using the option 
to store inadequate voltages. The data consists of two general sections: the first row starts with the string 
INDNOM and is followed by a list of numbers representing the nominal shift. The second and subsequent 
rows list the buses and inadequate voltages for any bus that has an inadequate voltage at any transfer 
level. Each row starts with the bus identifier followed by the voltages at that bus at the corresponding 
shift levels. If a voltage is not inadequate at a particular transfer level, a blank entry will appear instead of 
a voltage value. The bus identifier is based on the key field identifier chosen and can be number, name 
and nominal kV combination, or label.
202
Example:
<SUBDATA PVBusInadequateVoltages>
 // INDNOM ShiftLevel1 ShiftLevel2 ...
 // BUS Voltage1 Voltage2 ...
 INDNOM 0.000 100.000 200.000 300.000 400.000 500.000 
 "Bus '3'" 0.99269 0.99278 0.99282 0.99280 0.99273 0.99262 
 "Bus '4'" "" 1.00000 "" "" "" 
</SUBDATA>
PWQVResultListContainer
PWPVResultObject
This subdata section contains the results of a particular QV Curve scenario. These results will exist when 
tracking quantities with the QV curve tool. The data consists of two general sections: the first three rows 
of text contain the "independent axis" of the QV Curve. The first three rows start with the strings 
INDNOM, INDEXP, and INDIMP and are followed by a list of numbers representing the setpoint voltage 
representing the V of the QV curve. Following after these rows is a list of all the tracked quantities. Each 
tracked quantity row consists of three parts which are separated by the strings ?f= and &v= . The first 
part of the string represents a description of the power system object being tracked, the second part 
represents the field variable name being tracked, and the third contains a list of all the values at the 
various setpoint voltage levels.
Example:
<SUBDATA PWPVResultObject>
 INDNOM 1.100 1.093 1.083 1.073 1.063
 INDEXP 1.100 1.093 1.083 1.073 1.063
 INDIMP 1.100 1.093 1.083 1.073 1.063
 Bus '1'?f=BusPUVolt&v=1.05000 1.05000 1.05000 1.05000 1.05000
 Bus '1'?f=BusKVVolt&v=144.89999 144.89999 144.89999 144.89999 144.89999 </SUBDATA>
QVCurve
QVPoints
This subdata section contains a list of the QV Curve points calculated for the respect QVCurve. Each line 
consists of exactly six values:
PerUnitVoltage : The per unit voltage of the bus for a QV point.
FictitiousMvar : The amount of Mvar injection from the fictitious generator at this QV 
point.
ShuntDeviceMvar : The Mvar injection from any switched shunts at the bus.
TotalMvar : The total Mvar injection from switched shunts and the fictitious 
generator.
ReservesMvar : Total amount of Mvar reserves available at the bus.
ReservesTotalMvar : Total Mvar injection from the switched shunts, fictitious generator, and 
available reserves.
203
Example:
QVCURVE (BusNum,CaseName,qv_VQ0,qv_Q0,qv_Vmax,qv_QVmax,qv_VQmin,qv_Qmin,
 qv_Vmin,qv_QVmin,Qinj_Vmax,Qinj_0,Qinj_min,Qinj_Vmin)
{
5 "BASECASE" 0.880 0.000 1.100 312.490 0.480 -221.072 
 0.180 -86.334 191.490 -77.373 -244.075 -89.562
 <SUBDATA QVPoints>
 // NOTE: This bus has a constant impedance 
 // switched shunt value of -100 Mvar at it.
 //V(PU), Q(MVR), Q_shunt(MVR), Q_tot(MVR), Q_res(MVR), Q_tot_res(MVR)
 1.1000, 312.4898, -121.0000, 191.4898, 0.0000, 191.4898
 0.9800, 124.6619, -95.9656, 28.6963, 0.0000, 28.6963
 0.7800, -96.6202, -60.7808, -157.4010, 0.0000, -157.4010
 0.5800, -206.9895, -33.5960, -240.5855, 0.0000, -240.5855
 0.3800, -207.4962, -14.4113, -221.9075, 0.0000, -221.9075
 </SUBDATA>
}
QVCurve_Options
Sim_Solution_Options 
This subdata section contains solution options that will be used when running QV Curves. See 
explanation under the CTG_Options object type for more information.
RemedialAction
CTGElementAppend
This format is the same as for the Contingency objecttype except that the SolvePowerFlow action is not 
allowed.
CTGElement
This format is the same as for the Contingency objecttype except that the SolvePowerFlow action is not 
allowed. RemedialActionElement object types can also be directly created inside their own DATA section 
as well. 
SelectByCriteriaSet
SelectByCriteriaSetType
This subdata section contains a list of the display object types which are chosen to be selected. Each line 
of the section consists of the following:
DisplayObjectType : The object type of the display object.
(FilterName) : This field is optional, but must be given if either of the following fields is
given. See the Using Filters in Script Commands section for more 
information on specifying the filtername.
(WhichFields) : For display objects that can reference different fields, this sets which of 
those fields it should select (e.g. select only Bus Name Fields). The value 
may be either ALL or SPECIFIED.
(ListOfFields) : If WhichFields is set to SPECIFIED, then a delimited list of fields follows.
204
Example:
<SUBDATA SelectByCriteriaSetType>
 DisplayAreaField "" "ALL"
 DisplayBus ""
 DisplayBusField "Name of Bus Filter" "SPECIFIED" BusName BusPUVolt BusNum
 DisplayCircuitBreaker ""
 DisplaySubstation ""
 DisplaySubstationField "" "SPECIFIED" SubName SubNum BusNomVolt BGLoadMVR
 DisplayTransmissionLine ""
 DisplayTransmissionLineField "" "ALL"
</SUBDATA>
Area
This subdata section contains a list of areas which were chosen to be selected. Each line of the section 
consists of either the number or the name. When generated automatically by PowerWorld we also 
include the other identifier as a comment.
Example:
<SUBDATA Area>
 18 // NEVADA
 22 // SANDIEGO
 30 // PG AND E
 52 // AQUILA
</SUBDATA>
Zone
This subdata section contains a list of zones which were chosen to be selected. Each line of the section 
consists of either the number or the name. When generated automatically by PowerWorld we also 
include the other identifier as a comment.
Example:
<SUBDATA Zone>
 680 // ID SOLUT
 682 // WY NE IN
</SUBDATA>
ScreenLayer
This subdata section contains a list of screen layers which were chosen to be selected. Each line of the 
section consists of either the name.
Example:
<SUBDATA ScreenLayer>
 "Border"
 "Transmission Line Objects"
</SUBDATA>
ShapefileExportDescription
This object uses the same subdata sections as SelectByCriteriaSet. The only distinction is that only buses and lines can 
be exported.
StudyMWTransactions
ImportExportBidCurve
This subdata section contains the piecewise linear transactions cost curves for areas involved in a MW 
transaction. Costs are only for areas that are not on OPF control. Curves must be monotonically 
increasing. Each line corresponds to a point in the cost curve, and it has two values:
205
MW : The MW value. Use negative values for imports (purchase) and positive 
values for exports (sales)
Price : The price in $/MWh.
Two different cost curves can be entered for each transaction. One is for the cost curve relative to the 
Export Area specified in the transaction, and the other is for the cost curve relative to the Import Area 
specified in the transaction. The first curve that is listed in the SUBDATA section is the curve relative to 
the Export Area. The curve relative to the Import Area is denoted by the keyword REVERSE. Either or both 
of the curves can be blank. 
Example:
<SUBDATA ImportExportBidCurve>
 //MW Price[$/MWh]
 -20.00 5.00
 -10.00 10.00
 0.00 15.00
 10.00 20.00 
 20.00 45.00
 30.00 70.00
 REVERSE
 -25.00 7.00
 -15.00 12.00
 5.00 17.00
 15.00 22.00 
 25.00 47.00
 35.00 72.00
</SUBDATA>
SuperArea
SuperAreaArea
This subdata section contains a list of areas within each super area. Each line of text contains two values, 
the area number followed by a participation factor for the area that can be optionally used.
Example:
<SUBDATA SuperAreaArea>
 1 48.9
 5 34.2
 25 11.2
</SUBDATA>
TSSchedule
SchedPoint
This section stores the schedule time points used in Time Step Simulation. Each line contains seven 
values:
Date : The date of the point.
Hour : The hour of the point.
Pointtype : An integer specifying the point type.
0 : Numeric
1 : Boolean (Yes/No, Closed/Open)
2 : Text
Numeric Value : The numeric value if point type is Numeric. Otherwise it is just zero.
Boolean Value : The boolean value if point type is Boolean. Otherwise it is just false.
Text value : The text value if point type is Text. Otherwise it is just an empty string.
Audiofilename : The audio filename associated to the point. If none, it is just an empty 
string.
206
Example:
<SUBDATA SchedPoint>
 //Date Hour PointType NValue BValue TValue AValue
 5/8/2006 0 1.00 NO
 5/8/2006 6:00:00 AM 0 1.10 NO
 5/8/2006 12:00:00 PM 0 1.25 NO
</SUBDATA>
UserDefinedDataGrid
ColumnInfo
This follows the same convention as the ColumnInfo SUBDATA section described with the DataGrid 
objecttype.
207
SCRIPT Section for Display Auxiliary File
The syntax for script commands in Display Auxiliary Files is the same as for Auxiliary Files. See the SCRIPT Section and its 
sub-sections for details on the proper syntax. Any differences for display auxiliary files will be discussed below.
AXD Actions
The following script commands are available for AXD files
AutoInsertBorders;
Use this action to insert borders according to the settings in the AutoInsertBordersOptions object
AutoInsertBuses(LocationSource, MapProjection, AutoInsertBranches, InsertIfNotAlreadyShown, 
"filename", InsertSelected);
Use this action to insert buses based on specified location data.
LocationSource : "Bus", "Substation" or "File"
MapProjection : "Simple Conic", "Mercator", "Alaska" or "xy"
AutoInsertBranches : YES to insert transmission lines when finished, NO not to
InsertOnlyIfNotAlreadyShown
: YES if only buses that are not already shown should be inserted, NO to 
insert all buses.
"filename" : (optional) path to location source file (if LocationSource is "File")
FileCoordinates is no longer used. It should not be included when creating new auxiliary files, but if it is 
included in existing auxiliary files, it will be read and ignored. If MapProjection is set to “xy” and using a 
file, the file coordinates are assumed to be in x,y, otherwise, file coordinates are assumed to be lon, lat. 
FileCoordinates : (optional) format of coordinates in file "xy" or "lonlat" (if LocationSource 
is "File")
InsertSelected : (optional) Default is NO. YES is only insert buses that are selected 
(SELECTED = YES).
This command inserts bus display objects using the latitude and longitude stored with each bus, 
interpreted through the Mercator map projection. It inserts only the buses that have their 
Selected field set to YES and also adds the connecting branches, regardless of whether the buses 
are already displayed.
AutoInsertBuses("Bus", "Mercator", YES, NO, , YES);
AutoInsertGens(MinkV, InsertTextFields);
Use this action to insert generators.
MinkV : Minimum kV level to insert
InsertTextFields : (optional) insert text fields (default=YES)
This command inserts generator display objects for all generators connected to buses with a 
nominal voltage of 140 kV or higher. It places only the generator symbols without any 
accompanying text fields such as MW or Mvar labels.
AutoInsertGens(140, NO);
AutoInsertInterfaces(InsertPieCharts, PieChartSize);
Use this action to insert line flow objects.
InsertPieCharts : (optional) Insert pie charts as well (default=YES)
PieChartSize : (optional) default size of interface pie charts (default=50.0)
208
This command inserts interface display objects along with pie charts that visualize flow or 
loading. The pie charts are included (YES) and are set to a default size of 50.0 screen units.
AutoInsertInterfaces(YES, 50.0);
AutoInsertLineFlowObjects(MinkV, InsertOnlyIfNotAlreadyShown, LineLocation, Size, FieldDigits, 
FieldDecimals, TextPosition, ShowMW, ShowMvar, ShowMVA, ShowUnits, ShowComplex);
Use this action to insert line flow objects.
MinkV : Minimum kV level to insert (default=0)
InsertOnlyIfNotAlreadyShown: (optional) if existing line flow objects are ignored (default=YES)
LineLocation : (optional) where to insert flow objects (default=0)
0 : middle
1 : 10%/90%
2 : after stubs
Size : (optional) size (default=5.0)
FieldDigits : (optional) total digits in field (default=6)
FieldDecimals : (optional) digits to the right of the decimal (default=2)
TextPosition : (optional) position of fields relative to flow object (default=YES)
YES : above
NO : below
ShowMW : (optional) show MW field (default=YES)
ShowMvar : (optional) show Mvar field (default=YES)
ShowMVA : (optional) show MVA field (default=YES)
ShowSuffix : (optional) show field units (default=YES)
ShowComplex : (optional) show complex form (MW+jMvar) (default=NO)
This command inserts line flow arrow objects for transmission lines with a nominal voltage of 100 
kV or higher. It inserts arrows in the middle of the line (0), with a size of 5.0, showing MW and 
Mvar values (but not MVA), with units displayed (e.g., "MW") and text positioned above the 
arrow. It does not use complex format (MW + jMvar), and skips lines already shown.
AutoInsertLineFlowObjects(100, YES, 0, 5.0, 6, 2, YES, YES, YES, NO, 
YES, NO);
AutoInsertLineFlowPieCharts(MinkV, InsertOnlyIfNotAlreadyShown, InsertMSLines, Size);
Use this action to insert line flow pie charts.
MinkV : Minimum kV level to insert (default=0)
InsertOnlyIfNotAlreadyShown
: (optional) if existing line flow objects are ignored (default=YES)
InsertMSLines : (optional) insert pie charts for Multi-Section Lines (default=YES)
Size : (optional) size (default=5.0)
This command inserts line flow pie charts for all transmission lines with a nominal voltage of 50 
kV or higher. It skips lines that already have pie charts (YES), includes Multi-Section Lines (YES), 
and sets the size of each pie chart to 5.0 screen units.
AutoInsertLineFlowPieCharts(50, YES, YES, 5.0);
AutoInsertLines(MinkV, InsertTextFields, InsertEquivObjects, InsertZBRPieCharts, InsertMSLines, 
ZBRImpedance, NoStubsZBRs, SingleCBZRs);
Use this action to insert lines.
MinkV : (optional) minimum kV level to insert (default=0)
InsertTextFields : (optional) insert text fields (default=YES)
InsertEquivObjects : (optional) insert Equivalenced Objects (default=YES)
InsertZBRPieCharts : (optional) insert pie charts for lines with no limit and bus ties 
(default=NO)
209
InsertMSLines : (optional) insert MultiSecton Lines (default=YES)
ZBRImpedance : (optional) maximum PU impedance for bus ties (default =0.0001)
NoStubsZBRs : (optional) ignore stubs for bus ties (default=YES)
SingleCBZBRs : (optional) only insert a single circuit breaker (default=YES)
This command inserts transmission line display objects for lines with a nominal voltage of 50 kV 
or higher. It includes text fields, inserts equivalenced lines, skips pie charts for zero-impedance 
bus ties, includes Multi-Section Lines, treats lines with per-unit impedance ≤ 0.0001 as bus ties, 
ignores stubs when identifying those ties, and inserts only a single circuit breaker for each zeroimpedance bus tie.
AutoInsertLines(50, YES, YES, NO, YES, 0.0001, YES, YES);
AutoInsertLoads(MinkV, InsertTextFields);
Use this action to insert loads.
MinkV : Minimum kV level to insert (default=0)
InsertTextFields : (optional) insert text fields (default=YES)
This command inserts load display objects for buses with a nominal voltage of 50 kV or higher 
and includes text fields showing load details such as MW and Mvar values.
AutoInsertLoads(50, YES);
AutoInsertSwitchedShunts(MinkV, InsertTextFields);
Use this action to insert switched shunts.
MinkV : Minimum kV level to insert (default=0)
InsertTextFields : (optional) insert text fields (default=YES)
This command inserts switched shunt display objects (e.g., capacitor banks or reactors) 
connected to buses with a nominal voltage of 140 kV or higher and includes text fields showing 
shunt details like Mvar values.
AutoInsertSwitchedShunts(140, YES);
AutoInsertSubStations(LocationSource, MapProjection, AutoInsertBranches, InsertIfNotAlreadyShown, 
"filename", InsertSelected);
Use this action to insert substations based on specified location data.
LocationSource : "Bus", "Substation" or "File"
MapProjection : "Simple Conic", "Mercator", "Alaska" or "x,y"
AutoInsertBranches : YES to insert transmission lines when finished, NO not to
InsertOnlyIfNotAlreadyShown
: YES if only buses that are not already shown should be inserted, NO to 
insert all buses.
"filename" : (optional) path to location source file (if LocationSource is "File")
FileCoordinates is no longer used. It should not be included when creating new auxiliary files, but if it is 
included in existing auxiliary files, it will be read and ignored. If MapProjection is set to “xy” and using a 
file, the file coordinates are assumed to be in x,y, otherwise, file coordinates are assumed to be lon, lat. 
FileCoordinates : (optional) format of coordinates in file "xy" or "lonlat" (if LocationSource 
is "File")
InsertSelected : (optional) Default is NO. YES is only insert buses that are selected 
(SELECTED = YES).
210
This command inserts substation display objects using the latitude and longitude coordinates 
stored in each substation, interpreted with the Simple Conic map projection. It inserts only 
substations that are not already shown, adds branches between them, and includes all 
substations regardless of selection status.
AutoInsertSubStations("Substation", "Simple Conic", YES, YES, "", NO);
AutoInsertAreas(MapProjection, InsertIfNotAlreadyShown, InsertSelected);
Use this action to insert areas based on the latitude and longitude of the area (which is calculated as the 
average lat/long of buses in the area).
MapProjection : "Simple Conic", "Mercator", "Alaska" or "x,y"
InsertOnlyIfNotAlreadyShown
: (optional) Default is NO. YES if only areas that are not already shown 
should be inserted, NO to insert all areas.
InsertSelected : (optional) Default is NO. YES is only insert areas that are selected 
(SELECTED = YES).
This command inserts area display objects based on the average latitude and longitude of the 
buses within each area, using the Simple Conic map projection. It inserts all areas, regardless of
whether they are already displayed or selected.
AutoInsertAreas("Simple Conic", NO, NO);
AutoInsertInjectionGroups(MapProjection, InsertIfNotAlreadyShown, InsertSelected);
Use this action to insert injection groups based on the latitude and longitude of the injection group 
(which is calculated as the average lat/long of objects in the injection group).
MapProjection : "Simple Conic", "Mercator", "Alaska" or "x,y"
InsertOnlyIfNotAlreadyShown
: (optional) Default is NO. YES if only injection groups that are not already 
shown should be inserted, NO to insert all injection groups.
InsertSelected : (optional) Default is NO. YES is only insert injection groups that are 
selected (SELECTED = YES).
This command inserts injection group display objects based on the average latitude and 
longitude of the objects within each group, using the Simple Conic map projection. It inserts all 
injection groups, regardless of whether they are already shown or selected.
AutoInsertInjectionGroups("Simple Conic", NO, NO);
AutoInsertOwners(MapProjection, InsertIfNotAlreadyShown, InsertSelected);
Use this action to insert owners based on the latitude and longitude of the owner (which is calculated as 
the average lat/long of objects in the owner).
MapProjection : "Simple Conic", "Mercator", "Alaska" or "x,y"
InsertOnlyIfNotAlreadyShown
: (optional) Default is NO. YES if only owners that are not already shown 
should be inserted, NO to insert all owners.
InsertSelected : (optional) Default is NO. YES is only insert owners that are selected 
(SELECTED = YES).
This command inserts owner display objects based on the average latitude and longitude of the 
elements owned by each owner, using the Mercator map projection. It inserts only owners that 
are not already displayed and only those with their Selected field set to YES.
AutoInsertOwners("Mercator", YES, YES);
211
AutoInsertZones(MapProjection, InsertIfNotAlreadyShown, InsertSelected);
Use this action to insert zones based on the latitude and longitude of the zone (which is calculated as the 
average lat/long of buses in the zone).
MapProjection : "Simple Conic", "Mercator", "Alaska" or "x,y"
InsertOnlyIfNotAlreadyShown
: (optional) Default is NO. YES if only zones that are not already shown 
should be inserted, NO to insert all zones.
InsertSelected : (optional) Default is NO. YES is only insert zones that are selected 
(SELECTED = YES).
This command inserts zone display objects using the average x,y coordinates of the buses in each 
zone, interpreted with the x,y coordinate system. It inserts only zones that are not already 
displayed and only those with their Selected field set to YES.
AutoInsertZones("x,y", YES, YES);
FixFlowArrowLineEnds("OnelineName", "LayerName");
The unmoving line flow arrow indicators that can be displayed on lines may not always be setup correctly. 
This script corrects the flow arrows so that they look at the end of the line to which they are the closest to 
determine the direction of flow.
"OnelineName" : Optional – default is blank
The name of the oneline to which this action should be applied. The 
oneline must already be open. When not specified this action is applied 
to the oneline to which the display auxiliary file has been applied.
"LayerName" : Optional – default is blank
Name of the screen layer in which this action should be applied. When 
this is left blank the action is applied to all flow arrow objects regardless 
of the layer.
This command adjusts the direction of all unmoving flow arrows on the current one-line diagram. 
It determines the correct flow direction by checking which end of the line the arrow is closest to 
and orients the arrow accordingly. Since no oneline or layer is specified, it applies to all flow 
arrows on the active diagram, regardless of screen layer.
FixFlowArrowLineEnds(,);
FixFlowArrowPosition("OnelineName", "LayerName");
The unmoving line flow arrow indicators that can be displayed on lines are difficult to position properly. 
This script is intended to automate as much of the work as possible for positioning these objects.
"OnelineName" : Optional – default is blank
The name of the oneline to which this action should be applied. The 
oneline must already be open. When not specified this action is applied 
to the oneline to which the display auxiliary file has been applied.
"LayerName" : Optional – default is blank
Name of the screen layer in which this action should be applied. When 
this is left blank the action is applied to all flow arrow objects regardless 
of the layer.
This command repositions all static flow arrows on the currently active one-line diagram to 
improve their visual placement along the transmission lines. Since no oneline or layer is specified, 
it applies to all flow arrows on all layers of the active diagram.
FixFlowArrowPosition(,);
212
InsertConnectedBuses("BusIdentifier");
Insert oneline display buses that are connected to the identified bus.
"BusIdentifier" : Identifier for the bus for which connected display buses should be added. 
Bus can be identified as a data object "BUS Number", "BUS 
NameNomkV", or "BUS Label". When identified as a data object all 
display buses that are linked to this data bus will have display buses 
inserted.
Bus can also be identified as a display object "DISPLAYBUS BusNum 
SOAuxiliaryID" or "DISPLAYBUS BusName_NomVolt". When identified as 
a display object only display buses connected to this bus will be inserted.
This command inserts display objects for all buses directly connected to the bus identified as 
"BUS 1" on the one-line diagram. It places those connected buses visually, allowing you to easily 
expand the diagram from a single bus outward by showing its immediate electrical connections.
InsertConnectedBuses("BUS 1");
LoadAXDFromAXD("filename", CreateIfNotFound)
Use this action to apply a display auxiliary file via this script command that is part of another display 
auxiliary file.
"filename" : The file name of the display auxiliary file to load. See the Specifying File 
Names in Script Commands section for special keywords that can be 
used when specifying the file name.
CreateIfNotFound : Optional – default is NO when using the Legacy Auxiliary File Header 
format. Default is YES when using the Concise Auxiliary File Header 
format. 
This parameter is only enforced when the Create_if_not_found field 
for a Legacy Auxiliary File Header is set to PROMPT. Otherwise, YES is 
assumed. YES means that objects that cannot be found will be created 
while reading DATA sections from "filename".
This command loads and applies the display auxiliary file located at the specified path. If any 
objects referenced in DATA sections are not found on the current oneline, they will be created.
LoadAXDFromAXD("G:\Diagrams\SubstationView.axd", YES);
PanAndZoomToObject("ObjectID", "DisplayObjectType", "DoZoom");
Use this action to pan to and optionally zoom in on a display object. This action will find the first matching 
display object linked to the model object identified by ObjectID or the exact display object identified by 
ObjectID.
ObjectID : The object identifier that uniquely identifies the power system model 
object or display object. For example, to identify bus 123354, the 
ObjectID takes the form "BUS 123354".
DisplayObjectType : (optional) The display object type to find. When a power system model 
object is passed in for ObjectID, this parameter helps this action narrow 
down to what kind of display object to pan. For example, to find the first 
bus display object, use "DISPLAYBUS". (default="")
DoZoom : (optional) Whether or not to zoom after panning. (default=YES)
This command pans and zooms the one-line diagram to center on the display object for bus 1, 
specifically targeting a DISPLAYBUS object type. The zoom is enabled (YES), so the view will both 
move and magnify to focus directly on the bus's location in the diagram.
PanAndZoomToObject("BUS 1", "DISPLAYBUS", YES);
213
ResetStubLocations(ZBRImpedance, NoStubsZBRs);
Use this action to reset stub locations.
ZBRImpedance : (optional) max P.U. impedance for bus ties (default=0.0001)
NoStubsZBRs : (optional) Ignore stubs for bus ties (default=YES)
This command resets the placement of stub lines for the one-line diagram. It affects lines with a 
per-unit impedance ≤ 0.0001, and with YES specified, it preserves the existing layout of the bus 
objects, adjusting only the stubs for cleaner visual alignment.
ResetStubLocations(0.0001, YES);
General Script Commands
The following script commands defined above in the general SCRIPT section are available for display 
auxiliary files as well: 
ExitProgram
LoadScript
LoadData
SelectAll
UnSelectAll
SetData
SaveData
SaveDataWithExtra
CreateData
DeleteFile
RenameFile
CopyFile
SetCurrentDirectory
SaveObjectFields
214
DATA Section for Display Auxiliary File
The syntax for Display Auxiliary Files is the same as for Auxiliary Files. See the DATA Section and its sub-sections for 
details on the proper syntax. Any differences for display auxiliary files will be discussed below.
Key Fields
See the Key Fields topic in the DATA Section for general details.
Display objects have an additional key field used for identification because multiple objects can be present on the same 
one-line diagram that represent the same power system element. This extra key field is SOAuxiliaryID. This is a field 
that is unique for each type of display object and other key field combination. If there are two display buses that 
represent bus one in the power system, the SOAuxiliaryID field will be different for both. Simulator will automatically 
create unique identifiers when these objects are created graphically. They can also be user specified but are forced to be 
unique. This field does not need to be present when reading in a display auxiliary file, but if it is missing, Simulator 
assumes that the ID is "1". This field is the only key field identifier for objects that do not link to power system elements 
such as background lines and pictures, and therefore, should always be included when reading in these objects or the 
expected results may not be achieved. 
By going to the main menu and choosing Help, Export Display Object Fields you will obtain a list of fields available for 
each display object type. In this output, the key fields will appear with asterisks *.
Special Data Sections
There are several object types that should be noted here because they can impact the reading of an entire display auxiliary 
file, overall look of the resulting one-line diagram, or require special input to properly import/export the object.
GeographyDisplayOptions
Most objects supported in the display auxiliary file have coordinates that can be specified in the appropriate data sections. 
What these coordinates specify can be controlled by the GEOGRAPHYDISPLAYOPTIONS object. This object has only two 
fields available: MapProjection and ShowLonLat. There are four possible settings for MapProjection: "x,y", "Simple 
Conic", "Alaska", and "Mercator". The choice of projection will determine how the x,y values for display objects are 
interpreted. ShowLonLat can be either "YES" or "NO". If ShowLonLat is "YES", the setting specified for the 
MapProjection will be the longitude,latitude projection used when reading/writing the object x,y values. If ShowLonLat is 
"NO", the x,y values will always be interpreted as x,y regardless of the MapProjection setting. This object should be placed 
in the display auxiliary file before any other objects containing coordinates are read. If this object is not included in the 
auxiliary file, the coordinates will be interpreted based on the current settings of map projection and whether or not 
coordinates are showing longitude,latitude.
Picture
PICTURE objects represent background images that cannot be stored in a text file format. To properly include a PICTURE 
object in a display auxiliary file, the file containing the image must be saved and read along with the auxiliary file. The 
FileName field indicates the name and location of the image file. If the image file cannot be found when reading in a 
display auxiliary file and attempting to create a new object, no PICTURE object will be created. If attempting to update an 
existing object and the image file cannot be found, the object will not be updated with a new image, but the FileName
field will be updated with the specified file name.
PWFormOptions
One-line display options that affect the current display settings can be changed by using the PWFORMOPTIONS object. 
Usually, this object specifies named sets of options that can be selected and used to change the various one-line display 
options through the GUI. By including a specially named object, the current options can be changed through a display 
auxiliary file. PWFORMOPTIONS are named using the OOName field. Setting this field to 
215
"THESE_OPTIONS_ARE_APPLIED_TO_THE_CURRENT_DISPLAY" will apply the specified set of options to the current one-line 
when the file is read. When saving the entire one-line to a display auxiliary file, a PWFORMOPTIONS object with this name 
is added to the file by default.
View
Different views can be specified in the display auxiliary file using the VIEW object. Usually, this object is used to specify 
named sets of options used to select and change the view through the GUI. By including a specially named object, the 
current view can be changed through a display auxiliary file. VIEW objects are named using the ViewName field. Setting 
this field to "THIS_VIEW_IS_APPLIED_TO_THE_CURRENT_DISPLAY" will apply the specified set of view options to the current 
one-line when the file is read. When saving the entire one-line to a display auxiliary file, a VIEW object with this name is 
added to the file by default.
SubData Sections
The format described thus far works well for most kinds of data in Simulator. It does not work as well however for data 
that stores a list of objects. For example, a contingency stores some information about itself (such as its name), and then a 
list of contingency elements, and possible a list of limit violations as well. For data such as this, Simulator allows 
<SubData>, </SubData> tags that store lists of information about a particular object. This formatting looks like the 
following
object_type (list_of_fields)
{
value_list_1
 <SUBDATA subobject_type1>
 precise format describing an object_type1
 precise format describing an object_type1
 .
 .
 .
 </SUBDATA>
 <SUBDATA subobject_type2>
 precise format describing an object_type2
 precise format describing an object_type2
 .
 .
 .
 </SUBDATA>
value_list_2
 .
 .
 .
value_list_n
}
Note that the information contained inside the <SubData>, </SubData> tags may not be flexibly defined. It must be 
written in a precisely defined order that will be documented for each SubData type. The description of each of these 
SubData formats follows.
ColorMap
Same format as in data auxiliary files.
CustomColors
Same format as in data auxiliary files.
216
DisplayDCTramisssionLine
DisplayInterface
DisplayMultiSectionLine
DisplaySeriesCapacitor
DisplayTransformer
DisplayTransmissionLine
Line
Line
This is a list of points defining the graphical line used to represent the object. Each set of coordinates can 
be enclosed in square brackets, [ ], or the brackets can be eliminated. The brackets will be included when 
Simulator generates an auxiliary file. The individual coordinates are separated by the specified delimiter, 
either a space or a comma, and if the brackets are included, the same delimiter should be used to 
separate sets of coordinates. The list of points is in a somewhat free form and sets of coordinates can 
span multiple lines. Each point should either be in x,y coordinates or longitude,latitude coordinates. 
Which coordinates should be used depends on the current option settings for map projection and 
whether or not coordinates should be shown in longitude,latitude. If the display auxiliary file is 
automatically generated by Simulator, a comment will be included in the subdata section indicating the 
coordinate system in use during file creation.
Example using brackets and a comma delimiter:
<SUBDATA Line>
//Coordinates are x,y
 [14.00000000, 63.00000000], [14.00000000, 60.00000000],
 [20.00000000, 45.00000000], [20.00000000, 42.00000000]
</SUBDATA>
Example with no brackets and a space delimiter:
<SUBDATA Line>
//Coordinates are x,y
 14.00000000 63.00000000 14.00000000 60.00000000
 20.00000000 45.00000000 20.00000000 42.00000000
</SUBDATA>
DynamicFormatting
Same format as in data auxiliary files.
Filter
Same format as in data auxiliary files.
GeoDataViewStyle
Same format as in data auxiliary files.
217
PieChartGaugeStyle
ColorMap
This is a lookup table by percentage of scalar and color values. This lookup table will consist of 
consecutive lines of text with exactly three values:
Percentage : This is the percentage at which the following scalar and color should be 
applied.
Scalar : A scalar (multiplier) on the size of the pie chart/gauge.
Color : A color for the pie chart/gauge.
Example:
<SUBDATA ColorMap>
//Percentage Scalar Color
 85.0000 1.5000 33023
 100.0000 2.0000 255
</SUBDATA>
PWFormOptions
Same format as in data auxiliary files.
SelectByCriteriaSet
Same format as in data auxiliary files.
UserDefinedDataGrid
Same format as in data auxiliary files.
View
ScreenLayer
This is a list of screen layer names that are hidden in the current view. Each screen layer name is on a 
separate line of text.